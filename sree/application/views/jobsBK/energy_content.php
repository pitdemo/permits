<?php
$issuing_authority_id3=$issuing_authority_id2='';
 $name_of_ia='disabled="disabled"';
?>
<STYLE type="text/css">

body {margin-top: 0px;margin-left: 0px;}

#page_1 {position:relative; overflow: hidden; /*margin: 113px 0px 56px 38px;*/padding: 0px;border: none;width: 1024px; background-color:white; border:1px solid;}

#page_1 #p1dimg1 {position:absolute;top:0px;left:0px;z-index:-1;width:740px;height:1174px;}
#page_1 #p1dimg1 #p1img1 {width:1024px;height:1174px;}




.dclr {clear:both;float:none;height:1px;margin:0px;padding:0px;overflow:hidden;}

.ft0{font: bold 24px 'Helvetica';line-height: 29px;}
.ft1{font: 1px 'Helvetica';line-height: 1px;}
.ft2{font: bold 23px 'Helvetica';line-height: 27px;}
.ft3{font: 15px 'Calibri';line-height: 13px;}
.ft4{font: 1px 'Helvetica';line-height: 3px;}
.ft5{font: bold 12px 'Helvetica';line-height: 15px;}
.ft6{font: 12px 'Helvetica';line-height: 15px;}
.ft7{font: 1px 'Helvetica';line-height: 10px;}
.ft8{font: 13px 'Helvetica';line-height: 16px;}
.ft9{font: 1px 'Helvetica';line-height: 2px;}
.ft10{font: bold 10px 'Helvetica';line-height: 12px;}
.ft11{font: bold 12px 'Helvetica';line-height: 14px;}
.ft12{font: 1px 'Helvetica';line-height: 14px;}
.ft13{font: 12px 'Helvetica';line-height: 13px;}
.ft14{font: 1px 'Helvetica';line-height: 13px;}
.ft15{font: 12px 'Helvetica';line-height: 14px;}
.ft16{font: 1px 'Helvetica';line-height: 12px;}
.ft17{font: bold 12px 'Helvetica';line-height: 12px;}
.ft18{font: 1px 'Helvetica';line-height: 8px;}
.ft19{font: 1px 'Helvetica';line-height: 11px;}
.ft20{font: bold 12px 'Helvetica';line-height: 13px;}
.ft21{font: 1px 'Helvetica';line-height: 7px;}
.ft22{font: 13px 'Helvetica';line-height: 14px;}
.ft23{font: 12px 'Helvetica';line-height: 12px;}
.ft24{font: 1px 'Helvetica';line-height: 5px;}
.ft25{font: 1px 'Helvetica';line-height: 9px;}
.ft26{font: bold 12px 'Calibri';line-height: 13px;}
.ft27{font: bold 13px 'Calibri';line-height: 14px;}
.ft28{font: bold 13px 'Calibri';line-height: 12px;}
.ft29{font: bold 12px 'Calibri';line-height: 10px;}
.ft30{font: bold 12px 'Calibri';line-height: 12px;}
.ft31{font: bold 13px 'Calibri';line-height: 13px;}
.ft32{font: bold 11px 'Helvetica';line-height: 14px;}
.ft33{font: bold 11px 'Helvetica';line-height: 13px;}
.ft34{font: 11px 'Helvetica';line-height: 13px;}
.ft35{font: 1px 'Helvetica';line-height: 6px;}
.ft36{font: 9px 'Helvetica';line-height: 12px;}
.ft37{font: 11px 'Helvetica';line-height: 14px;}
.ft38{font: bold 13px 'Calibri';line-height: 15px;}

.p0{text-align: left;padding-left: 190px;margin-top: 5px;margin-bottom: 0px;}
.p1{text-align: left;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p2{text-align: left;padding-left: 108px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p3{text-align: left;padding-left: 3px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p4{text-align: left;padding-left: 1px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p5{text-align: left;padding-left: 2px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p6{text-align: left;padding-left: 22px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p7{text-align: left;padding-left: 51px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p8{text-align: left;padding-left: 47px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p9{text-align: left;padding-left: 10px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p10{text-align: left;padding-left: 33px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p11{text-align: left;padding-left: 6px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p12{text-align: left;padding-left: 9px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p13{text-align: right;padding-right: 15px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p14{text-align: left;padding-left: 4px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p15{text-align: left;padding-left: 7px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p16{text-align: left;padding-left: 5px;margin-top: 0px;margin-bottom: 0px;}
.p17{text-align: left;padding-left: 8px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p18{text-align: left;padding-left: 24px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p19{text-align: left;padding-left: 19px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p20{text-align: center;padding-left: 1px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p21{text-align: center;padding-right: 3px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p22{text-align: left;padding-left: 5px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p23{text-align: center;padding-right: 7px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p24{text-align: left;padding-left: 59px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p25{text-align: left;padding-left: 30px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p26{text-align: center;padding-left: 24px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p27{text-align: center;padding-right: 12px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p28{text-align: center;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p29{text-align: center;padding-right: 5px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p30{text-align: center;padding-right: 13px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
.p31{text-align: left;padding-left: 13px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}

.td0{padding: 0px;margin: 0px;width: 3px;vertical-align: bottom;}
.td1{padding: 0px;margin: 0px;width: 29px;vertical-align: bottom;}
.td2{padding: 0px;margin: 0px;width: 104px;vertical-align: bottom;}
.td3{padding: 0px;margin: 0px;width: 416px;vertical-align: bottom;}
.td4{padding: 0px;margin: 0px;width: 188px;vertical-align: bottom;}
.td5{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 3px;vertical-align: bottom;}
.td6{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 133px;vertical-align: bottom;}
.td7{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 189px;vertical-align: bottom;}
.td8{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 78px;vertical-align: bottom;}
.td9{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 90px;vertical-align: bottom;}
.td10{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 11px;vertical-align: bottom;}
.td11{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 45px;vertical-align: bottom;}
.td12{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 66px;vertical-align: bottom;}
.td13{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 122px;vertical-align: bottom;}
.td14{padding: 0px;margin: 0px;width: 322px;vertical-align: bottom;}
.td15{padding: 0px;margin: 0px;width: 78px;vertical-align: bottom;}
.td16{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 89px;vertical-align: bottom;}
.td17{padding: 0px;margin: 0px;width: 56px;vertical-align: bottom;}
.td18{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 65px;vertical-align: bottom;}
.td19{padding: 0px;margin: 0px;width: 122px;vertical-align: bottom;}
.td20{padding: 0px;margin: 0px;width: 135px;vertical-align: bottom;}
.td21{padding: 0px;margin: 0px;width: 54px;vertical-align: bottom;}
.td22{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 121px;vertical-align: bottom;}
.td23{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 29px;vertical-align: bottom;}
.td24{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 104px;vertical-align: bottom;}
.td25{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 89px;vertical-align: bottom;}
.td26{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 65px;vertical-align: bottom;}
.td27{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 103px;vertical-align: bottom;}
.td28{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 134px;vertical-align: bottom;}
.td29{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 2px;vertical-align: bottom;}
.td30{padding: 0px;margin: 0px;width: 146px;vertical-align: bottom;}
.td31{padding: 0px;margin: 0px;width: 66px;vertical-align: bottom;}
.td32{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 132px;vertical-align: bottom;}
.td33{padding: 0px;margin: 0px;width: 90px;vertical-align: bottom;}
.td34{padding: 0px;margin: 0px;width: 11px;vertical-align: bottom;}
.td35{padding: 0px;margin: 0px;width: 45px;vertical-align: bottom;}
.td36{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 103px;vertical-align: bottom;}
.td37{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 135px;vertical-align: bottom;}
.td38{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 54px;vertical-align: bottom;}
.td39{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 31px;vertical-align: bottom;}
.td40{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 238px;vertical-align: bottom;}
.td41{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 181px;vertical-align: bottom;}
.td42{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 10px;vertical-align: bottom;}
.td43{border-right: #000000 1px solid;border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 28px;vertical-align: bottom;}
.td44{border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 104px;vertical-align: bottom;}
.td45{border-right: #000000 1px solid;border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 134px;vertical-align: bottom;}
.td46{border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 54px;vertical-align: bottom;}
.td47{border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 78px;vertical-align: bottom;}
.td48{border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 3px;vertical-align: bottom;}
.td49{border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 90px;vertical-align: bottom;}
.td50{border-right: #000000 1px solid;border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 10px;vertical-align: bottom;}
.td51{border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 45px;vertical-align: bottom;}
.td52{border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 66px;vertical-align: bottom;}
.td53{border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 122px;vertical-align: bottom;}
.td54{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 31px;vertical-align: bottom;}
.td55{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 134px;vertical-align: bottom;}
.td56{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 10px;vertical-align: bottom;}
.td57{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 28px;vertical-align: bottom;}
.td58{padding: 0px;margin: 0px;width: 149px;vertical-align: bottom;}
.td59{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 149px;vertical-align: bottom;}
.td60{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 322px;vertical-align: bottom;}
.td61{padding: 0px;margin: 0px;width: 233px;vertical-align: bottom;}
.td62{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 400px;vertical-align: bottom;}
.td63{padding: 0px;margin: 0px;width: 400px;vertical-align: bottom;}
.td64{border-right: #000000 1px solid;border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 24px;vertical-align: bottom;}
.td65{border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 2px;vertical-align: bottom;}
.td66{border-right: #000000 1px solid;border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 77px;vertical-align: bottom;}
.td67{border-right: #000000 1px solid;border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 79px;vertical-align: bottom;}
.td68{border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 13px;vertical-align: bottom;}
.td69{border-right: #000000 1px solid;border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 64px;vertical-align: bottom;}
.td70{border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 51px;vertical-align: bottom;}
.td71{border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 9px;vertical-align: bottom;}
.td72{border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 167px;vertical-align: bottom;}
.td73{border-right: #000000 1px solid;border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 12px;vertical-align: bottom;}
.td74{border-right: #000000 1px solid;border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 116px;vertical-align: bottom;}
.td75{border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 31px;vertical-align: bottom;}
.td76{border-top: #000000 1px solid;padding: 0px;margin: 0px;width: 87px;vertical-align: bottom;}
.td77{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 24px;vertical-align: bottom;}
.td78{padding: 0px;margin: 0px;width: 2px;vertical-align: bottom;}
.td79{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 140px;vertical-align: bottom;}
.td80{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 140px;vertical-align: bottom;}
.td81{padding: 0px;margin: 0px;width: 13px;vertical-align: bottom;}
.td82{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 47px;vertical-align: bottom;}
.td83{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 17px;vertical-align: bottom;}
.td84{padding: 0px;margin: 0px;width: 51px;vertical-align: bottom;}
.td85{padding: 0px;margin: 0px;width: 9px;vertical-align: bottom;}
.td86{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 12px;vertical-align: bottom;}
.td87{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 116px;vertical-align: bottom;}
.td88{padding: 0px;margin: 0px;width: 31px;vertical-align: bottom;}
.td89{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 2px;vertical-align: bottom;}
.td90{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 13px;vertical-align: bottom;}
.td91{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 17px;vertical-align: bottom;}
.td92{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 51px;vertical-align: bottom;}
.td93{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 9px;vertical-align: bottom;}
.td94{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 60px;vertical-align: bottom;}
.td95{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 16px;vertical-align: bottom;}
.td96{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 43px;vertical-align: bottom;}
.td97{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 40px;vertical-align: bottom;}
.td98{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 8px;vertical-align: bottom;}
.td99{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 12px;vertical-align: bottom;}
.td100{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 31px;vertical-align: bottom;}
.td101{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 87px;vertical-align: bottom;}
.td102{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 19px;vertical-align: bottom;}
.td103{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 60px;vertical-align: bottom;}
.td104{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 32px;vertical-align: bottom;}
.td105{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 15px;vertical-align: bottom;}
.td106{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 8px;vertical-align: bottom;}
.td107{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 59px;vertical-align: bottom;}
.td108{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 42px;vertical-align: bottom;}
.td109{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 64px;vertical-align: bottom;}
.td110{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 6px;vertical-align: bottom;}
.td111{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 4px;vertical-align: bottom;}
.td112{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 314px;vertical-align: bottom;}
.td113{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 220px;vertical-align: bottom;}
.td114{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 18px;vertical-align: bottom;}
.td115{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 74px;vertical-align: bottom;}
.td116{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 374px;vertical-align: bottom;}
.td117{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 24px;vertical-align: bottom;}
.td118{padding: 0px;margin: 0px;width: 463px;vertical-align: bottom;}
.td119{padding: 0px;margin: 0px;width: 64px;vertical-align: bottom;}
.td120{padding: 0px;margin: 0px;width: 6px;vertical-align: bottom;}
.td121{padding: 0px;margin: 0px;width: 4px;vertical-align: bottom;}
.td122{padding: 0px;margin: 0px;width: 43px;vertical-align: bottom;}
.td123{padding: 0px;margin: 0px;width: 87px;vertical-align: bottom;}
.td124{padding: 0px;margin: 0px;width: 74px;vertical-align: bottom;}
.td125{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 372px;vertical-align: bottom;}
.td126{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 218px;vertical-align: bottom;}
.td127{padding: 0px;margin: 0px;width: 18px;vertical-align: bottom;}
.td128{padding: 0px;margin: 0px;width: 60px;vertical-align: bottom;}
.td129{padding: 0px;margin: 0px;width: 16px;vertical-align: bottom;}
.td130{padding: 0px;margin: 0px;width: 40px;vertical-align: bottom;}
.td131{padding: 0px;margin: 0px;width: 8px;vertical-align: bottom;}
.td132{padding: 0px;margin: 0px;width: 490px;vertical-align: bottom;}
.td133{padding: 0px;margin: 0px;width: 235px;vertical-align: bottom;}
.td134{padding: 0px;margin: 0px;width: 314px;vertical-align: bottom;}
.td135{padding: 0px;margin: 0px;width: 70px;vertical-align: bottom;}
.td136{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 25px;vertical-align: bottom;}
.td137{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 61px;vertical-align: bottom;}
.td138{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 148px;vertical-align: bottom;}
.td139{padding: 0px;margin: 0px;width: 198px;vertical-align: bottom;}
.td140{padding: 0px;margin: 0px;width: 32px;vertical-align: bottom;}
.td141{padding: 0px;margin: 0px;width: 15px;vertical-align: bottom;}
.td142{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 490px;vertical-align: bottom;}
.td143{padding: 0px;margin: 0px;width: 25px;vertical-align: bottom;}
.td144{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 1px;vertical-align: bottom;}
.td145{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 18px;vertical-align: bottom;}
.td146{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 105px;vertical-align: bottom;}
.td147{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 85px;vertical-align: bottom;}
.td148{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 39px;vertical-align: bottom;}
.td149{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 26px;vertical-align: bottom;}
.td150{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 68px;vertical-align: bottom;}
.td151{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 84px;vertical-align: bottom;}
.td152{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 82px;vertical-align: bottom;}
.td153{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 63px;vertical-align: bottom;}
.td154{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 77px;vertical-align: bottom;}
.td155{padding: 0px;margin: 0px;width: 61px;vertical-align: bottom;}
.td156{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 76px;vertical-align: bottom;}
.td157{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 1px;vertical-align: bottom;}
.td158{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 18px;vertical-align: bottom;}
.td159{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 68px;vertical-align: bottom;}
.td160{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 75px;vertical-align: bottom;}
.td161{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 82px;vertical-align: bottom;}
.td162{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 76px;vertical-align: bottom;}
.td163{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 50px;vertical-align: bottom;}
.td164{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 15px;vertical-align: bottom;}
.td165{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 63px;vertical-align: bottom;}
.td166{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 30px;vertical-align: bottom;}
.td167{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 198px;vertical-align: bottom;}
.td168{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 144px !important;vertical-align: bottom;}
.td169{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 235px;vertical-align: bottom;}
.td170{padding: 0px;margin: 0px;width: 105px;vertical-align: bottom;}
.td171{padding: 0px;margin: 0px;width: 19px;vertical-align: bottom;}
.td172{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 14px;vertical-align: bottom;}
.td173{padding: 0px;margin: 0px;width: 154px;vertical-align: bottom;}
.td174{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 7px;vertical-align: bottom;}
.td175{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 70px;vertical-align: bottom;}
.td176{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 3px;vertical-align: bottom;}
.td177{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 118px;vertical-align: bottom;}
.td178{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 83px;vertical-align: bottom;}
.td179{border-right: #000000 1px solid;padding: 0px;margin: 0px;width: 3px;vertical-align: bottom;}
.td180{padding: 0px;margin: 0px;width: 69px;vertical-align: bottom;}
.td181{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 105px;vertical-align: bottom;}
.td182{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 14px;vertical-align: bottom;}
.td183{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 154px;vertical-align: bottom;}
.td184{border-right: #000000 1px solid;border-bottom: #000000 1px solid;padding: 0px;margin: 0px;width: 7px;vertical-align: bottom;}
.td185{padding: 0px;margin: 0px;width: 399px;vertical-align: bottom;}
.td186{padding: 0px;margin: 0px;width: 339px;vertical-align: bottom;}

.tr0{height: 33px;}
.tr1{height: 3px;}
.tr2{height: 18px;}
.tr3{height: 28px;}
.tr4{height: 10px;}
.tr5{height: 27px;}
.tr6{height: 2px;}
.tr7{height: 16px;}
.tr8{height: 14px;}
.tr9{height: 13px;}
.tr10{height: 15px;}
.tr11{height: 21px;}
.tr12{height: 12px;}
.tr13{height: 17px;}
.tr14{height: 26px;}
.tr15{height: 8px;}

.tr16{height: 11px;}
.tr17{height: 23px;}
.tr18{height: 20px;}
.tr19{height: 7px;}
.tr20{height: 5px;}
.tr21{height: 9px;}
.tr22{height: 25px;}
.tr23{height: 6px;}
.tr24{height: 29px;}

.t0{width: 740px;font: 12px 'Helvetica';}
.t1{width: 741px;font: 12px 'Helvetica';}
.remove_border_right{border-right: none !important;}/*swathi*/

.td137 { width:66px !important; padding-top:20px; text-align: center;}

</STYLE>

<style type="text/css">
.border_right { border-right: 1px solid black; padding:5px;}
label.error { display:none !important; }
input,textarea { 
    text-transform: uppercase;
}
select[disabled] {
   color: black !important;
}
textarea.error { border-color:red; }

.add_more { color:green; font-weight:bold; font-size:22px; text-decoration: none; text-align: center;} .remove { color:red; font-weight: bold; font-size:22px;  text-decoration: none; padding-left:25px;}
<?php
	if($is_popup!=1)
	{
?>
table,#page_1 { width:100% !important; }
<?php
	}
?>	

</style>

<script type="text/javascript">

$(document).ready(function() {

	$('body').on('change','.isolated_equipment_tag_nos',function() 
	{ 

		var val=$(this).val();
		
		var data_attr=$(this).attr('data-attr');

		var checker = {};

		if(val=='')
		{
			$('.isolation_equipment_row'+data_attr).val('').attr('disabled','disabled');;
		}
		else
		{

			var is_flag=0;

			var is_check=$('.isolated_equipment_tag_nos').filter(function () 
			{
				if($(this).val()!='')
				{
					//var allow_equip=$('#allow_equip'+val).html(); && allow_equip==0
					
					if ( checker[this.value])
					{
						alert('You already selected this tag no');
						
						$(this).val('');
						
						is_flag=1;
					}
					else
						checker[this.value] = true;
				}
					return this.value;
			});


			if(is_flag==0)
			{

				var iso_id=$(this).find(':selected').attr('data-iso-type-id');

				console.log('SS44 '+iso_id + ' = '+data_attr);

				//$('select[name="isolated_isolate_types['+data_attr+']"]').removeAttr('disabled');

				$('select[name="isolated_isolate_types['+data_attr+']"]').val(iso_id);

				$('select[name="isolated_isolate_types['+data_attr+']"]').trigger('change');

				$('select[name="isolated_equipment_descriptions['+data_attr+']"]').removeAttr('disabled');

				$('input[name="isolated_tagno1['+data_attr+']"]').removeAttr('disabled');

				$('input[name="isolated_tagno2['+data_attr+']"]').removeAttr('disabled');

				$('select[name="isolated_name['+data_attr+']"]').removeAttr('disabled');

			}
		}
	});	


	$('.isolated_isolate_types').change(function() 
	{
			
			var val=$(this).val();
			
			var data_attr=$(this).attr('data-attr');
			
			//isolated_name[]
			
			var data = new FormData();
			
			$('select[name="isolated_name['+data_attr+']"],select[name="isolated_equipment_descriptions['+data_attr+']"]').html('<option value="">- - Select - -</option>');	
			
			if(val!='')
			{
				data.append('isolation_type_id',val);
				
				$.ajax({
					url: base_url+'jobs_isolations/ajax_get_isolation_users/',
					type: 'POST',
					"beforeSend": function(){  },
					data: data,
					cache: false,
					dataType: 'json',
					processData: false, // Don't process the files
					contentType: false, // Set content type to false as jQuery will tell the server its a query string request
					success: function(data, textStatus, jqXHR)
					{
						if(data.success)
						{
						 	$('select[name="isolated_name['+data_attr+']"]').html(data.success);
						}				
					},
					error: function(jqXHR, textStatus, errorThrown)
					{
						
					}
				});
				
				$.ajax({
					url: base_url+'jobs_isolations/ajax_get_isolation_descriptions/',
					type: 'POST',
					"beforeSend": function(){  },
					data: data,
					cache: false,
					dataType: 'json',
					processData: false, // Don't process the files
					contentType: false, // Set content type to false as jQuery will tell the server its a query string request
					success: function(data, textStatus, jqXHR)
					{
						if(data.success)
						{
						 	$('select[name="isolated_equipment_descriptions['+data_attr+']"]').html(data.success);
						}				
					},
					error: function(jqXHR, textStatus, errorThrown)
					{
						
					}
				});				
			}
	});	
});
</script>

    <?php
	
	$job_status_error_msg=(isset($job_status_error_msg))? $job_status_error_msg : '';
	
	$temp_show=$issuing_authority_id2_date='';$department_user_validation=0;
	
	$eip_completed_departments=unserialize(EIP_COMPLETED_DEPARTMENTS);
	
	$user_role=strtolower($this->session->userdata('user_role'));
	
	if($job_status_error_msg!='')
	{
	?>	
        <div class="alert alert-danger">
        <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
        <strong><?php echo $job_status_error_msg; ?></strong> 
       </div>
     <?php
	}

	$this->load->view('layouts/msg');
	?>

<!-- #include virtual="/convert-pdf-to-html/includes/pdf-to-word-body-tag-02242014.htm" -->
	<table align="center" width="100%">
    <tr>
    	<td style="padding-left:25px;">&nbsp;</td>
        <td valign="top">
        <?php $eip_id=(isset($records['id'])) ? $records['id'] : '';        		
		
			  $approval_status=(isset($records['approval_status'])) ? $records['approval_status'] : '';		
			  
			  $issuing_authority_id2_approval=$issuing_authority_id3_approval=$performing_authority_id2_approval='';	 
			  
			  $select_department=(isset($records['department_id'])) ? $records['department_id'] : '';	
			  
		if($isolations->num_rows()>0)
		$isolations=$isolations->result_array();
		else
		$isolations='';
		
			  
		?>
        <form id="job_form" name="job_form" enctype="multipart/form-data" >	
        <input type="hidden" id="id" name="id" value="<?php echo $eip_id; ?>" />
        <input type="hidden" id="show_button" name="show_button" />
        <input type="hidden" name="modified" id="modified" value="<?php echo (isset($records['modified'])) ? $records['modified'] : ''; ?>" />
        
        <input type="hidden" id="approval_status" name="approval_status" value="<?php echo $approval_status; ?>" />
        <?php
			if($eip_id>0)
			{	
				
			  $st='';
			  	
			  $final_status_date = (isset($records['final_status_date'])) ? $records['final_status_date'] : '';	
			  /*if($user_role!='sa')
			  {		
			  	  if($final_status_date=='')
				  $st='visibility:hidden;';

			  }	  
			  else */
			  $st='';
			
			echo '&nbsp;<a href="javascript:void(0);" data-id="'.$eip_id.'" style="float:right;'.$st.'" class="print_out"><i class="fa fa-print"> Print PDF</i></a>';
			} 
		?>	       
			<DIV id="page_1">
<DIV class="dclr"></DIV>
    <P class="p0 ft0">Dalmia Cement (B) Ltd - <?php echo BRANCH_NAME; ?></P>
    
    <p class="status2">
    <TABLE cellpadding=0 id="table1" cellspacing=0 class="t0" style="width:1024px;" align="center">
    <TR>
        <TD class="tr0 td0"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr0 td1"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr0 td2"><P class="p1 ft1">&nbsp;</P></TD>
        <TD colspan=7 class="tr0 td3"><P class="p2 ft2">Energy Isolation Permit</P></TD>
        <TD colspan=2 class="tr0 td4"><P class="p1 ft3">EIP.NO. <?php echo $sl_no; ?></P></TD>
    </TR>
    <TR>
        <TD class="tr1 td5"><P class="p1 ft4">&nbsp;</P></TD>
        <TD colspan=2 class="tr1 td6"><P class="p1 ft4">&nbsp;</P></TD>
        <TD colspan=2 class="tr1 td7"><P class="p1 ft4">&nbsp;</P></TD>
        <TD class="tr1 td8"><P class="p1 ft4">&nbsp;</P></TD>
        <TD class="tr1 td5"><P class="p1 ft4">&nbsp;</P></TD>
        <TD class="tr1 td9"><P class="p1 ft4">&nbsp;</P></TD>
        <TD class="tr1 td10"><P class="p1 ft4">&nbsp;</P></TD>
        <TD class="tr1 td11"><P class="p1 ft4">&nbsp;</P></TD>
        <TD class="tr1 td12"><P class="p1 ft4">&nbsp;</P></TD>
        <TD class="tr1 td13"><P class="p1 ft4">&nbsp;</P></TD>
    </TR>
    <TR>
        <TD class="tr2 td0"><P class="p1 ft1">&nbsp;</P></TD>
        <TD colspan=5 class="tr2 td14 border_right" valign="top" ><P class="p3 ft5">(A) To be filled by the Performing Authority :</P></TD>
        <TD class="tr2 td0"><P class="p1 ft1">&nbsp;</P></TD>
        <TD colspan="3" class="tr2 td16">
          Date:
            <input style="width:150px;" type="text" class="form-control" name="date_start" readonly id="date_start" value="<?php echo (isset($records['date_start'])) ? date('d-m-Y',strtotime($records['date_start'])) : date('d-m-Y'); ?>">
           </TD>
        <TD class="tr2 td19" style="padding-left: 5px;">Valid Upto: 
           <input style="width:150px;" type="text" class="form-control" readonly name="date_end" id="date_end" value="<?php echo (isset($records['date_end'])) ? date('d-m-Y',strtotime($records['date_end'])) : date('d-m-Y',strtotime("+15 days")); ?>" />
        </TD>
    </TR>
    <TR>
        <TD class="tr3 td0"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr3 td1"><P class="p1 ft1">&nbsp;</P></TD>
        <TD colspan="4" class="tr3 td2 border_right"></TD>
        <TD class="tr3 td0"></TD>
        <TD colspan="3" class="tr3 td16">Time :
        <input type="text" readonly class="form-control" name="time_start" id="time_start" value="<?php echo (isset($records['time_start'])) ? $records['time_start'] : date('H:i'); ?>" />
        <?php #echo generate_time(array('width'=>'150px','name'=>'time_start','selected_value'=>(isset($records['time_start'])) ? $records['time_start'] : '')); ?>
        </TD>
        <TD class="tr3 td19"  style="padding-left: 5px;">Time  : 
          
          <input type="text" readonly name="time_end" id="time_end" class="form-control" style="width:150px;" value="<?php echo (isset($records['time_end'])) ? $records['time_end'] : date('H:i'); ?>">
          
        </TD>
    </TR>
    <TR>
        <TD colspan="6"  class="tr4 td25 border_right"></TD>
        <TD colspan="4"  class="tr4 td25 border_right"></TD>
        <TD colspan="4"  class="tr4 td25 border_right remove_border_right"></TD><!-- swathi -->
    </TR>
    <TR>
        <TD colspan="2" class="border_right" ><P class="p7 ft8">Dept</P></TD>
         <TD  class="border_right" ><P class="p7 ft8">Zone</P></TD>
        <TD colspan="3" class="border_right" ><P class="p7 ft8">Section</P></TD>
        <TD colspan="4" class="border_right" ><P class="p1 ft8">Area</P></TD>
        <TD colspan=4 class="border_right remove_border_right" ><P class="p5 ft8">Ref.Work Permit Nos.</P></TD><!-- swathi -->
    </TR>
    <TR>
        <TD colspan=2 class="border_right" ><select disabled class="form-control zone_list" name="department_id" id="department_id" style="width:180px;margin:0 5px 5px 5px;">
                                    <option value="">- - Select Department - - </option>
                                    <?php 	
                                        $zone_name='';
                                        		  
                                        if($departments->num_rows()>0)
                                        {
                                             $departments=$departments->result_array();
    
                                            foreach($departments as $list){
                                                
                                                if($select_department==$list['id'])
                                                $zone_name=$list['name'];
                                                
                                                
                                                ?>
                                    <option value="<?php echo $list['id'];?>" <?php if($select_department==$list['id']) { ?> selected="selected" <?php } ?>><?php echo $list['name'];?></option>
                                    <?php }} ?>
                                  </select></TD>
        <TD class="border_right" ><select disabled class="form-control" name="zone_id" id="zone_id" style="width:180px;margin:0 5px 5px 5px;">
                                    <option value="">- - Select Zone - - </option>
                                <?php 	
									$zone_name='';
									$select_zone_id=(isset($records['zone_id'])) ? $records['zone_id'] : '';			  
									if($zones->num_rows()>0)
				  				    {
										 $zones=$zones->result_array();

                                        foreach($zones as $list){
											
											?>
                                <option value="<?php echo $list['id'];?>" <?php if($select_zone_id==$list['id']) { ?> selected="selected" <?php } ?>><?php echo $list['name'];?></option>
                                <?php }} ?>
                                  </select></TD>
        <TD colspan=3 class="border_right" ><input type="text" class="form-control" name="section" id="section" value="<?php echo (isset($records['section'])) ? $records['section'] : ''; ?>"  /></TD>
        <TD colspan=4 class="border_right" ><input style="width:150px;" type="text" class="form-control" name="area" id="area" value="<?php echo (isset($records['area'])) ? $records['area'] : ''; ?>"  /></TD>
        <!-- swathi -->
        <TD colspan=4 class="border_right remove_border_right" >
        	<input style="width:250px;" readonly  type="text" class="form-control" name="work_permit_nos" id="work_permit_nos" value="<?php echo (isset($records['work_permit_nos'])) ? $records['work_permit_nos'] : ''; ?>"  /></TD>
    </TR>
    <TR style='border-top: #000000 1px solid;'>
        <TD class="tr7 td5"><P class="p1 ft1">&nbsp;</P></TD>
        <TD colspan=11 class="tr7 td6"><b>Description of Work:</b> <!-- swathi -->
        	<span id="job_descriptions">
        	<?php
        		if(count($job_descriptions)>0)
        		{
        			$conf_job_approvals=unserialize(CONFINED_JOBAPPROVALS);

        			$confined_closed_permit=unserialize(CONFINED_CLOSE_PERMITS);

        			$confined_closed_permit=array_merge($confined_closed_permit,array(4));

        			$closed_jobs=unserialize(CLOSED_JOBS);

        			$job_approvals=unserialize(JOBAPPROVALS);

        			$work_permit_status=$records['work_permit_status'];

        			


        			#echo '<pre>'; print_r($work_permit_status); exit;
        	?>		
        	
        	<ol>
        		<?php
        			foreach($job_descriptions as $job_desc)
        			{
        					$color='red';

		        			if(substr($job_desc['permit_no'],0,2)=='CP')
		        			{
		        				if(in_array($work_permit_status[$job_desc['permit_no']],$confined_closed_permit))
		        					$color='green';

		        				$work_permit_status_info=$conf_job_approvals[$work_permit_status[$job_desc['permit_no']]];
		        			}
		        			else
		        			{
		        				if(in_array($work_permit_status[$job_desc['permit_no']],$closed_jobs))
		        					$color='green';

		        				$work_permit_status_info=$job_approvals[$work_permit_status[$job_desc['permit_no']]];

		        			}
	        	?>		
        		<li style="margin-left:10px;color:<?php echo $color; ?>;">#<?php echo $job_desc['permit_no'].' - '.$job_desc['job_name'].'(<i>'.$work_permit_status_info.'</i>)'; ?></li>
        		<?php
	        		}
	        	?>	
        	</ol>
        	<?php
        	}
        	?>
        	</span>
        </TD>
    </TR>
</table>
	
	<TABLE cellpadding=0 id="isolation_table" cellspacing=0 class="t0" style="width:1024px;" align="center" >

    
        <?php
        
         if($records)
         $equipment_descriptions=json_decode($records['equipment_descriptions']);
         else
         $equipment_descriptions=array();

         if($records)
         $equipment_tag_nos=json_decode($records['equipment_tag_nos']);
         else
         $equipment_tag_nos=array();

         if($records)
         $isolate_types=json_decode($records['isolate_types']);
         else
         $isolate_types=array();

      	 $total_equipment_tags=isset($records['is_checklist']) ? $records['is_checklist'] : EIP_CHECKLIST_MAX_ROWS;

     	
     	#echo '<pre>'; print_r(array_filter(json_decode($equipment_descriptions,true)));

     	 if($records)
         $equipment_remarks=$records['equipment_remarks'];
         else
         $equipment_remarks=array();

         if($records)
         $equipment_radio=$records['equipment_radio'];
         else
         $equipment_radio=array();

         $remarks_issuing_date=(isset($records['remarks_issuing_date'])) ? $records['remarks_issuing_date'] : '';


       ?>
    
    </table>

    <TABLE cellpadding=0 id="table1" cellspacing=0 class="t0" style="width:1024px;" align="center">
    <TR>
        <TD class="tr10 td0"><P class="p1 ft1">&nbsp;</P></TD>
        <TD colspan=4 class="tr10 td14"><P class="p14 ft5">Name of the Performing Authority :</P></TD>
        <TD class="tr10 td15"><P class="p1 ft1">&nbsp;</P></TD>
        <TD colspan=4 class="tr10 td58"><P class="p1 ft6">Signature/Date & Time:</P> </TD>
        <TD class="tr10 td31"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr10 td19"><P class="p1 ft1">&nbsp;</P></TD>
    </TR>
    <TR>
        <TD class="tr11 td5"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr11 td23">
        <?php
		$remarks_performing_id=(isset($records['remarks_performing_id'])) ? $records['remarks_performing_id'] : '';
		?>
        
        <select style="width:150px;" id="remarks_performing_id" name="remarks_performing_id"  class="form-control authority performing generate_date" data-date-field="remarks_performing_date" data-issue-field="remarks_issuing_id">
                                      <option value="" selected="selected">- - Select - -</option>
                                      <?php
      
      if($authorities!='')
      {
          foreach($authorities as $fet)
          {
              $role=$fet['user_role'];
              
              $id=$fet['id'];
              
              $first_name=$fet['first_name'];
              
              $chk='';
			  
			  $flag=0;
			  
		  			if($eip_id=='')
					{
						 if($id==$user_id)
						 $flag=1;
					}
					else
					{
						if($remarks_performing_id==$id)
						$flag=1;
					}
					
			  if($flag==1)
			  {
			  
                    if($remarks_performing_id==$id) $chk='selected';
      ?>
                                      <option value="<?php echo $id; ?>" <?php echo $chk; ?>><?php echo $first_name; ?></option>
                                      <?php
			  }
          }
      }
       ?>
                                    </select></TD>
        <TD class="tr11 td24"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr11 td37"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr11 td38"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr11 td8"><P class="p1 ft1">&nbsp;</P></TD>
        <TD colspan=6 class="tr11 td59"><input readonly type="text" class="form-control" name="remarks_performing_date" id="remarks_performing_date" style="width:150px;" value="<?php echo (isset($records['remarks_performing_date'])) ? $records['remarks_performing_date'] : ''; ?>" /></TD>
    </TR>
    <TR>
        <TD class="tr12 td5"><P class="p1 ft16">&nbsp;</P></TD>
        <TD colspan=4 class="tr12 td60"><P class="p5 ft17">(B) Remarks by the Issuing Authority:</P> </TD>
        <TD class="tr12 td8"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td5"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td9"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td10"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td11"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td12"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td13"><P class="p1 ft16">&nbsp;</P></TD>
    </TR>
    <TR>
        <TD class="tr13 td0"><P class="p1 ft1">&nbsp;</P></TD>
        <TD colspan=2 class="tr13 td14 border_right" style="vertical-align:top;"><P class="p5 ft6">1. List of Equipment where isolation is required is OK.</P></TD>
       
        <TD class="tr13 td33 border_right" colspan="6"><P class="p1 ft1">&nbsp;</P>2. Following additional isolations / safety measures are required.</TD>
        
        <TD colspan=3 class="tr13 td61" valign="top" style="vertical-align: top;padding-top: 5px;"><P class="p15 ft5">Name of the Issuing Authority :</P></TD>
    </TR>
    <?php
	$remarks_issuing_id=(isset($records['remarks_issuing_id'])) ? $records['remarks_issuing_id'] : '';
	?>
    <TR>
        <TD class="tr6 td5"><P class="p1 ft9">&nbsp;</P></TD>
        <TD colspan=2 class="tr6 td62 border_right" style="vertical-align:top;"><P class="p1 ft9">&nbsp;</P><br /> <textarea class="form-control" name="remarks_issuing_authority_1" <?php if($user_id!=$remarks_issuing_id) { ?> disabled="disabled" <?php } ?> id="remarks_issuing_authority_1"><?php echo (isset($records['remarks_issuing_authority_1'])) ? $records['remarks_issuing_authority_1'] : ''; ?></textarea> <br /></TD>
        <TD class="tr6 td5 border_right" colspan="6" style="vertical-align:top;"><P class="p1 ft9">&nbsp;</P><br /><textarea class="form-control" name="remarks_issuing_authority_2" <?php if($user_id!=$remarks_issuing_id) { ?> disabled="disabled" <?php } ?>  id="remarks_issuing_authority_2"><?php echo (isset($records['remarks_issuing_authority_2'])) ? $records['remarks_issuing_authority_2'] : ''; ?></textarea> <br />
        </TD>
       
        <TD class="tr1 td19" colspan="3" style="vertical-align: top;">
        
        <select style="margin:5px;width: 165px;"  disabled id="remarks_issuing_id" name="remarks_issuing_id" class="form-control issuing authority">
                                      <option value="">- - Select - -</option>
                                      <?php
      
	  if($issuing_authorities!='')
	  {
		  foreach($issuing_authorities as $fet)
		  {


			  $role=$fet['user_role'];
			  
			  $id=$fet['id'];
			  
			  $first_name=$fet['first_name'];
			  
			  $chk='';
			  
			  $flag=0;
			  
						if($eip_id=='')
						{
							 if($id!=$user_id)
							 $flag=1;
						}
						else
						{
							if($id!=$remarks_performing_id)
							$flag=1;	
							
						}
						
			  if($flag==1)
			  {
					if($remarks_issuing_id==$id) $chk='selected';
	  ?>
									  <option value="<?php echo $id; ?>" <?php echo $chk; ?>><?php echo $first_name; ?></option>
									  <?php
			  }
		  }
	  }
       ?>
                                    </select>
                          
                          
		<?php             
			$remarks_issuing_approval=(isset($records['remarks_issuing_approval'])) ? $records['remarks_issuing_approval'] : '';	                      
			if($remarks_issuing_approval=='No' && $user_id==$remarks_issuing_id && $eip_id!='')                                    
			$records['remarks_issuing_date']=date('d-m-Y H:i');
			
			$remarks_issuing_date=(isset($records['remarks_issuing_date'])) ? $records['remarks_issuing_date'] : '';
			
			if(!empty($remarks_issuing_date))
			$remarks_issuing_date=date('d-m-Y H:i',strtotime($remarks_issuing_date));
			
			
		?>	
                                    <br /><P class="p15 ft6">Signature/Date & Time:</P>
                                    <p><input readonly type="text" class="form-control" name="remarks_issuing_date" id="remarks_issuing_date" style="width:150px;margin:5px;" value="<?php echo $remarks_issuing_date; ?>"  /></p>
                                    
                                    </TD>
    </TR>
   
    <TR>
        <TD class="tr15 td5"><P class="p1 ft18">&nbsp;</P></TD>
        <TD class="tr15 td23" colspan="6"><P class="p1 ft18">&nbsp;</P></TD>
        
        <TD class="tr15 td9"><P class="p1 ft18">&nbsp;</P></TD>
        <TD class="tr15 td56"><P class="p1 ft18">&nbsp;</P></TD>
    </TR>
    
    
    <TR>
        <TD class="tr16 td0"><P class="p1 ft19">&nbsp;</P></TD>
        <TD class="tr16 td1"><P class="p1 ft19">&nbsp;</P></TD>
        <TD class="tr16 td2"><P class="p1 ft19">&nbsp;</P></TD>
        <TD class="tr16 td20"><P class="p1 ft19">&nbsp;</P></TD>
        <TD class="tr16 td21"><P class="p1 ft19">&nbsp;</P></TD>
        <TD class="tr16 td15"><P class="p1 ft19">&nbsp;</P></TD>
        <TD class="tr16 td0"><P class="p1 ft19">&nbsp;</P></TD>
        <TD class="tr16 td33"><P class="p1 ft19">&nbsp;</P></TD>
        <TD class="tr16 td42"><P class="p1 ft19">&nbsp;</P></TD>
    </TR>
    <TR>
        <TD class="tr6 td5"><P class="p1 ft9">&nbsp;</P></TD>
        <TD class="tr6 td23"><P class="p1 ft9">&nbsp;</P></TD>
        <TD class="tr6 td24"><P class="p1 ft9">&nbsp;</P></TD>
        <TD class="tr6 td37"><P class="p1 ft9">&nbsp;</P></TD>
        <TD class="tr6 td38"><P class="p1 ft9">&nbsp;</P></TD>
        <TD class="tr6 td8"><P class="p1 ft9">&nbsp;</P></TD>
        <TD class="tr6 td5"><P class="p1 ft9">&nbsp;</P></TD>
        <TD class="tr6 td9"><P class="p1 ft9">&nbsp;</P></TD>
        <TD class="tr6 td56"><P class="p1 ft9">&nbsp;</P></TD>
        <TD class="tr6 td11"><P class="p1 ft9">&nbsp;</P></TD>
        <TD class="tr6 td12"><P class="p1 ft9">&nbsp;</P></TD>
        <TD class="tr6 td13"><P class="p1 ft9">&nbsp;</P></TD>
    </TR>
    </TABLE>
    </p>
    <?php 
	
	$is_isolators='';
	
	$isolation_approval_counts=10;
	
	if($remarks_issuing_approval=='Yes')
	{
	
	?>	
    <P class="p16 ft11">(c) To be filled by the authorized person (Performing Authority/Isolator) who is carrying out the isolations.</P>

    <style>
    	.equip_table td { border: 1px solid black; text-align:center; height:20px; }
    	.equip_table td:first-child { border-left-style: none !important; }
    	.equip_table td.equip_table_label { font-weight:bold; }
    	.equip_table td select { width:170px !important; }
    	.equip_table td input { padding-left:15px !important; }
    </style>
    <p>&nbsp;</p>
    <table align="center" width="100%" border="1" class="equip_table">
    	<tr>
    		<td class="equip_table_label">Sl.No</td>
    		<td class="equip_table_label">Equipment Tag No</td>
    		<td class="equip_table_label">Isolation Type</td>
    		<td class="equip_table_label">Description of Isolation</td>
    		<td class="equip_table_label" >PA Lock</td>
    		<td class="equip_table_label" >PA TAG</T>
    		<td class="equip_table_label">ISO Lock</td>
    		<td class="equip_table_label">Name of the Auth. Isolator</td>
    		<td class="equip_table_label">Signaute/Date&Time</td>
    	</tr>

    	<?php
    	         
    	 if(isset($records))
         $isolated_equipment_descriptions=json_decode($records['isolated_equipment_descriptions']);
         else
         $isolated_equipment_descriptions=array();

         if(isset($records))
         $isolated_equipment_tag_nos=json_decode($records['isolated_equipment_tag_nos']);
         else
         $isolated_equipment_tag_nos=array();
     	

         if(isset($records))
         $isolated_isolate_types=json_decode($records['isolated_isolate_types']);
         else
         $isolated_isolate_types=array();

         if(isset($records))
         $isolated_tagno1=json_decode($records['isolated_tagno1']);
         else
         $isolated_tagno1=array();

         if(isset($records))
         $isolated_tagno2=json_decode($records['isolated_tagno2']);
         else
         $isolated_tagno2=array();

         if(isset($records))
         $isolated_tagno3=json_decode($records['isolated_tagno3']);
         else
         $isolated_tagno3=array();

         if(isset($records))
         $isolated_tagno4=json_decode($records['isolated_tagno4']);
         else
         $isolated_tagno4=array();
		
         if(isset($records))
         $isolated_name=json_decode($records['isolated_name']);
         else
         $isolated_name=array();

     	 if(isset($records))
         $isolated_ia_names=json_decode($records['isolated_ia_name']);
         else
         $isolated_ia_names=array();

         if(isset($records))
         $isolated_name_approval=json_decode($records['isolated_name_approval']);
         else
         $isolated_name_approval=array();
 
         if(isset($records))
         $isolated_name_approval_datetime=json_decode($records['isolated_name_approval_datetime']);
         else
         $isolated_name_approval_datetime=array(); 
		 
		 $issuing_authority_id2_date=(isset($records['issuing_authority_id2_date'])) ? $records['issuing_authority_id2_date'] : '';

		# echo '<br /> Count '.$total_equipment_tags; 

		 $additional_rows=EIP_CHECKLIST_ADDITIONAL_ROWS_START;

		 if($equipment_radio)
		 	$equipment_radio_count=count(json_decode($equipment_radio,true));
		 else
		 	$equipment_radio_count = 0;

		 $eq_radios=array();

		  #echo '<br /> Total EQ '.$total_equipment_tags;

		 if($equipment_radio_count>0)
		 {
	 		$eq_radios=json_decode($equipment_radio,true);

	 		$total_equipment_tags=array_count_values($eq_radios);

	 		$total_equipment_tags=(isset($total_equipment_tags['Yes'])) ? $total_equipment_tags['Yes'] : 0;
		 }

		 #echo '<br /> Total EQ '.$total_equipment_tags;
        for($i=1;$i<=$total_equipment_tags;$i++)
        {
            $isolated_equipment_description=(isset($isolated_equipment_descriptions->$i)) ? $isolated_equipment_descriptions->$i : '';

            #echo '<br /> ID '.$isolated_equipment_description.' = '.$issuing_authority_id2_date;

            if($isolated_equipment_description=='' && $issuing_authority_id2_date!='')
            break;
			
			$isolated_name_id=(isset($isolated_name->$i)) ? $isolated_name->$i : '';

			$isolated_ia_name=(isset($isolated_ia_names->$i)) ? $isolated_ia_names->$i : '';
			
			$isolated_name_approval=(isset($isolated_name_approval->$i)) ? $isolated_name_approval->$i : '';

			$isolated_name_approval_dttime=(isset($isolated_name_approval_datetime->$i)) ? $isolated_name_approval_datetime->$i : '';

			
			if($isolated_name_id==$user_id && $isolated_name_approval_dttime=='')
			$is_isolators=1;
			
			if( ($remarks_performing_id!=$user_id) || ($remarks_performing_id==$user_id && $isolated_name_approval!='') || $approval_status==4 )
			$disabled='disabled="disabled"';
			else
			$disabled='';
			#echo 'S '.$isolated_name_id.' - '.$user_id.' - '.$remarks_performing_id;
			
			$disabled2='';
			
			if($approval_status==4)
			$disabled2='disabled="disabled"';
			else
			{
			 	if($isolated_name_id!=$user_id)
				$disabled2='disabled="disabled"';
			}

			$isolate_types_array=json_decode($records['isolate_types'],true);
			
					
        ?>
		
		<tr>
			<td><?php echo $i; ?></td>
			<td>        
			<?php

				$isolated_equipment_tag_no=(isset($isolated_equipment_tag_nos->$i)) ? $isolated_equipment_tag_nos->$i : '';
				
				/*if($isolated_equipment_tag_no=='')
				{
					$isolated_equipment_tag_no=(isset($equipment_tag_nos->$i)) ? $equipment_tag_nos->$i : '';	

					$equipment_radio=(isset($equipment_radio->$i)) ? $equipment_radio->$i : NO;	
					#echo 'FF '.$isolated_equipment_tag_no;

					if($isolated_equipment_tag_no=='')				
						$isolated_equipment_tag_no=(isset($equipment_tag_nos->$additional_rows)) ? $equipment_tag_nos->$additional_rows : '';	

					if($equipment_radio!='')
					{
						if($equipment_radio==NO)
						$isolated_equipment_tag_no='';	
					}
				}*/

				#echo '<pre>'; print_r($equipment_descriptions);
				

				if($isolated_name_approval_dttime!='')
				$disabled=$disabled2='disabled="disabled"';
			?>
       		 <!-- <input type="text" class="form-control" name="isolated_equipment_tag_nos[<?php echo $i; ?>]" id="isolated_equipment_tag_nos[<?php echo $i; ?>]"  value="<?php echo $isolated_equipment_tag_no; ?>"  style="margin:2px;width:140px;" <?php  echo $disabled; ?>   /> -->
       		 	<select data-attr="<?php echo $i; ?>"  class="form-control isolated_equipment_tag_nos " name="isolated_equipment_tag_nos[<?php echo $i; ?>]" id="isolated_equipment_tag_nos[<?php echo $i; ?>]" <?php  echo $disabled; ?> >
       		 		<option value="" selected="selected">- - Select - -</option>
       		 		<?php 
       		 		if($equipment_radio_count>0)
       		 		{
       		 			foreach($eq_radios as $key => $value):

       		 				if($value==YES)
       		 				{
       		 					$value=$equipment_tag_nos->$key;

       		 					$isolate_type_id=$isolate_types->$key;

       		 					$vv=$equipment_descriptions->key;

       		 					$sel='';

       		 					if($isolated_equipment_tag_no==$value)
       		 						$sel="selected='selected'";

       		 					echo '<option value="'.$value.'" '.$sel.' data-iso-type-id="'.$isolate_type_id.'">'.strtoupper($value).'</option>';	
       		 				}
       		 			endforeach;	
       		 		}
       		 		else
       		 		{
       		 			$eq_tag_nos=json_decode(json_encode($equipment_tag_nos),true);

       		 			foreach($eq_tag_nos as $key => $value):
       		 					$isolate_type_id=$isolate_types->$key;

       		 					$sel='';

       		 					if($isolated_equipment_tag_no==$value)
       		 						$sel="selected='selected'";

       		 					echo '<option value="'.$value.'" '.$sel.' data-iso-type-id="'.$isolate_type_id.'">'.strtoupper($value).'</option>';	
       		 			endforeach;
       		 		}
       		 		?>
       		 	</select>


       		</td>
        <td> 		

        	<?php 
				$isolated_isolate_type=(isset($isolated_isolate_types->$i)) ? $isolated_isolate_types->$i : '';
				
				/*if($isolated_isolate_type=='')
				{
					$isolated_isolate_type=(isset($isolate_types->$i)) ? $isolate_types->$i : '';


					if($isolated_isolate_type=='')
					{ $isolated_isolate_type=(isset($isolate_types->$additional_rows)) ? $isolate_types->$additional_rows : '';	
					  $additional_rows++;
					}  
				}*/

				if(empty($isolated_equipment_tag_no) || $isolated_name_approval_dttime!='')
				$disabled=$disabled2='disabled="disabled"';



			?>	
			<select style="margin:5px;width:120px;" name="isolated_isolate_types[<?php echo $i; ?>]" id="isolated_isolate_types[<?php echo $i; ?>]" class="form-control isolated_isolate_types isolation_equipment_row<?php echo $i; ?>" <?php  #echo $disabled; ?> disabled="disabled" data-attr="<?php echo $i; ?>" >
                                      <option value="">- Select -</option>
                                      <?php
	  if(count($isolations)>0)
	  {
		  foreach($isolations as $fet)
		  {
			  $record_type=$fet['record_type'];
			  
			  $id=$fet['id'];
			  
			  $name=$fet['name'];
			  
			  $chk='';
			  
			  if($record_type=='isolation_type' && in_array($id,$isolate_types_array))
			  {
					if($isolated_isolate_type==$id) $chk='selected';
	  ?>
									  <option value="<?php echo $id; ?>" <?php echo $chk; ?>><?php echo $name; ?></option>
									  <?php
			  }
		  }
	  }
       ?>
                                    </select>   </td>
        <td><select style="margin:5px;width:82px;"  id="isolated_equipment_descriptions[<?php echo $i; ?>]"  name="isolated_equipment_descriptions[<?php echo $i; ?>]" class="form-control isolated_equipment_descriptions isolation_equipment_row<?php echo $i; ?>" <?php  echo $disabled; ?>>
                                      <option value="">- Select-</option>
                                      <?php
	  if(count($isolations)>0)
	  {
		  foreach($isolations as $fet)
		  {
			 
			  $record_type=$fet['record_type'];
			  
			  $id=$fet['id'];
			  
			  $name=$fet['name'];
			  
			  $isolation_type_id=$fet['isolation_type_id'];
			  
			 # echo '<br /> AA : '.$isolation_type_id.' - '.$isolated_isolate_type;
			  $chk='';
			  if($record_type=='description' && $isolated_isolate_type==$isolation_type_id)
			  {
			  
					if($isolated_equipment_description==$id) $chk='selected';
	  ?>
									  <option value="<?php echo $id; ?>" <?php echo $chk; ?>><?php echo $name; ?></option>
									  <?php
			  }
		  }
	  }
       ?>
                                    </select></td>
                                    
		<td><input type="text" class="form-control numinput isolation_equipment_row<?php echo $i; ?>" name="isolated_tagno1[<?php echo $i; ?>]" id="isolated_tagno1[<?php echo $i; ?>]" 
            value="<?php echo (isset($isolated_tagno1->$i)) ? $isolated_tagno1->$i : ''; ?>" <?php  echo $disabled; ?>  style="margin:2px;width:72px;"  /></td>
		<td><input type="text" class="form-control numinput isolation_equipment_row<?php echo $i; ?>" name="isolated_tagno2[<?php echo $i; ?>]" id="isolated_tagno2[<?php echo $i; ?>]" 
            value="<?php echo (isset($isolated_tagno2->$i)) ? $isolated_tagno2->$i : ''; ?>" <?php  echo $disabled; ?>  style="margin:2px;width:72px;"  /></td>      
        <td><input type="text" class="form-control numinput isolation_equipment_row<?php echo $i; ?>" name="isolated_tagno3[<?php echo $i; ?>]" id="isolated_tagno3[<?php echo $i; ?>]" 
            value="<?php echo (isset($isolated_tagno3->$i)) ? $isolated_tagno3->$i : ''; ?>"  style="margin:2px;width:72px;" <?php  echo $disabled2;  ?>  /></td>
        <td> <input type="hidden" name="isolated_name_approval[<?php echo $i; ?>]" id="isolated_name_approval[<?php echo $i; ?>]" 
            value="<?php echo $isolated_name_approval; ?>"  class="isolation_equipment_row<?php echo $i; ?>"/> 
            
           
			<select style="margin:5px;width:140px;" name="isolated_name[<?php echo $i; ?>]" id="isolated_name[<?php echo $i; ?>]" class="form-control isolated_name data-iso-name<?php echo $isolated_name_id; ?> isolation_equipment_row<?php echo $i; ?>"  data-attr="<?php echo $i; ?>" <?php  echo $disabled; ?>>
                                      <option value="">- Select -</option>
                                    <?php
									if(!empty($isolated_isolate_type))
									{
											$get_iso=$this->jobs_isolations_model->get_isolation_users(array('isolation_type_id'=>$isolated_isolate_type));
											
											if($get_iso->num_rows()>0)
											{
												 $fet_iso=$get_iso->result_array();
		
												foreach($fet_iso as $list)
												{
													if($list['id']==$isolated_name_id)
													$chk="selected='selected'";
													else
													$chk='';
													
													?>
										<option value="<?php echo $list['id'];?>" <?php echo $chk; ?>><?php echo $list['first_name'];?></option>
										<?php }}
									}
									 ?>
                                    </select></td>
			<?php
			if($isolated_name_approval_dttime=='' && $disabled2=='')
			$isolated_name_approval_dttime=date('d-m-Y H:i');
			?>
			<td align="center">
			<input type="text" disabled="disabled" name="isolated_name_approval_datetime[<?php echo $i; ?>]" id="isolated_name_approval_datetime[<?php echo $i; ?>]" value="<?php echo $isolated_name_approval_dttime; ?>" class="form-control isolation_equipment_row<?php echo $i; ?>" style="margin:10px;width:115px;font-size:11px;"  data-attr="<?php echo $i; ?>"  />
			<br />
			<div><b style="float:left;padding-left:10px;">Name of the IA </b></div>
			<input type="text" name="isolated_ia_name[<?php echo $i; ?>]" id="isolated_ia_name[<?php echo $i; ?>]" value="<?php echo $isolated_ia_name; ?>" class="form-control isolation_equipment_row<?php echo $i; ?>" style="margin:10px;width:115px;font-size:11px;" <?php  echo $disabled2;  ?> data-attr="<?php echo $i; ?>"  />
		</td> 
		</tr>
						<?php
						if($isolated_equipment_tag_no=='' && $approval_status>=2)
						{

						?>
							<script type="text/javascript">
								
								$(document).ready(function() {


										$('select[name="isolated_equipment_tag_nos[<?php echo $i; ?>]"] option:eq(<?php echo $i; ?>)').attr('selected', 'selected');


										$('select[name="isolated_equipment_tag_nos[<?php echo $i; ?>]"]').trigger('change');
								});

							</script>		
						<?php
						}
						?>	
		<?php } ?>
    </table>		

        
        <?php
		if($approval_status>3)
		{
		?>	
        <TABLE cellpadding=0 cellspacing=0 class="t1" id="table3" style="width:1024px;" align="center">
    <TR>
        <TD class="tr8 td5"><P class="p1 ft12">&nbsp;</P></TD>
        <TD colspan=10 class="tr8 td112"><P class="p5 ft11">(D) To be filled and ensured by the Issuing authority</P></TD>
        <TD class="tr8 td93"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td94"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td95"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td96"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td97"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td98"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td90"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td109"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td110"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td111"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td96"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td100"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td101"><P class="p1 ft12">&nbsp;</P></TD>
    </TR>
    <?php
      $yes_active='';
      $no_active=$na_active='';
      if(isset($records))
      {
          $is_equipment_stopped=(isset($records['is_equipment_stopped'])) ? $records['is_equipment_stopped'] : '';
          
          if($is_equipment_stopped=='No') 
          $no_active='checked';
          else if($is_equipment_stopped=='N/A')
          $na_active='checked';
          else
          $yes_active='checked';
      }
      else
      $na_active='checked';
     ?>
    <TR>
        <TD class="tr13 td5"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr13 td77"><P class="p11 ft8">1</P></TD>
        <TD colspan=7 class="tr13 td113"><P class="p17 ft6">Is equipment stopped & Isolated</P></TD>
        <TD class="tr13 td114"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr13 td92"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr13 td93"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr13 td94"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr13 td95"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr13 td96"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr13 td97"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr13 td98"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr13 td99"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr13 td109"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr13 td110"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr13 td111"><P class="p1 ft1">&nbsp;</P></TD>
        <TD colspan=4 class="tr13 td115"><P class="p4 ft6" align="center">
        <input type="radio" name="is_equipment_stopped" class="radio_button on_off"  <?php echo $yes_active; ?> value="Yes"/>
                                  Yes
                                  &nbsp;
                                  <input name="is_equipment_stopped" <?php echo $no_active; ?> type="radio" value="No" class="radio_button on_off" data-relate='isoloation'/>
                                  No&nbsp;
                                  <input name="is_equipment_stopped" value="N/A" <?php echo $na_active; ?> type="radio" class="radio_button on_off" data-relate='isoloation' />
                                  N/A</P></TD>
    </TR>
    
    <?php
      $yes_active='';
      $no_active=$na_active='';
      if(isset($records))
      {
          $is_equipment_stopped=(isset($records['is_stopped_isoloated'])) ? $records['is_stopped_isoloated'] : '';
          
          if($is_equipment_stopped=='No') 
          $no_active='checked';
          else if($is_equipment_stopped=='N/A')
          $na_active='checked';
          else
          $yes_active='checked';
      }
      else
      $na_active='checked';
     ?>
    
    <TR>
        <TD class="tr8 td5"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td77"><P class="p11 ft22">2</P></TD>
        <TD colspan=12 class="tr8 td116"><P class="p17 ft15">Are preceding & Succeeding Equipments also stopped & Isolated</P></TD>
        <TD class="tr8 td96"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td97"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td98"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td99"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td109"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td110"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr13 td111"><P class="p1 ft1">&nbsp;</P></TD>
        <TD colspan=4 class="tr8 td8"><P class="p21 ft15" style="text-align:left;">
        <input type="radio" name="is_stopped_isoloated" class="radio_button on_off" data-relate='isoloation' <?php echo $yes_active; ?> value="Yes"/>
                                  Yes
                                  &nbsp;
                                  <input name="is_stopped_isoloated" <?php echo $no_active; ?> type="radio" value="No" class="radio_button on_off" data-relate='isoloation'/>
                                  No&nbsp;
                                  <input name="is_stopped_isoloated" value="N/A" <?php echo $na_active; ?> type="radio" class="radio_button on_off" data-relate='isoloation' />
                                  N/A</P></TD>
    </TR>
    <TR>
        <TD class="tr8 td0"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td117"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td78"><P class="p1 ft12">&nbsp;</P></TD>
        <TD colspan=14 class="tr8 td118"><P class="p11 ft15">Has the vessel/equipment/pipe line been positively isolated from all sources?</P></TD>
        <TD class="tr8 td86"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td119"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td120"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td121"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td122"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td88"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td123"><P class="p1 ft12">&nbsp;</P></TD>
    </TR>
    <?php
      $yes_active='';
      $no_active=$na_active='';
      if(isset($records))
      {
          $is_isoloation_drained_fully=(isset($records['is_isoloation_drained_fully'])) ? $records['is_isoloation_drained_fully'] : '';
          
          if($is_isoloation_drained_fully=='No') 
          $no_active='checked';
          else if($is_isoloation_drained_fully=='N/A')
          $na_active='checked';
          else
          $yes_active='checked';
      }
      else
      $na_active='checked';
	  
	  $is_isoloation_drained_fully_options=(isset($records['is_isoloation_drained_fully_options'])) ? explode(',',$records['is_isoloation_drained_fully_options']) : array();
	  
	 # echo '<pre>'; print_r(json_decode($is_isoloation_drained_fully_options));
     ?>
    
    <TR>
        <TD class="tr7 td0"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr7 td117"><P class="p11 ft8">3</P></TD>
        <TD class="tr7 td78"><P class="p1 ft1">&nbsp;</P></TD>
        <TD colspan=14 class="tr7 td118"><P class="p11 ft6">(<input class="is_isoloation_drained_fully_options" type="checkbox" name="is_isoloation_drained_fully_options[]" value="including compressed air" <?php if(in_array('including compressed air',$is_isoloation_drained_fully_options)) { ?> checked="checked" <?php } ?>  /> Including compressed air <input type="checkbox" name="is_isoloation_drained_fully_options[]" class="is_isoloation_drained_fully_options" value="supply to air blaster"  <?php if(in_array('supply to air blaster',$is_isoloation_drained_fully_options)) { ?> checked="checked" <?php } ?>/> Supply to air blaster <input type="checkbox" name="is_isoloation_drained_fully_options[]" class="is_isoloation_drained_fully_options" value="input material"  <?php if(in_array('input material',$is_isoloation_drained_fully_options)) { ?> checked="checked" <?php } ?>/> Input material </P></TD>
        <TD class="tr7 td86"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr7 td119"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr7 td120"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr7 td121"><P class="p1 ft1">&nbsp;</P></TD>
        <TD colspan=2 class="tr7 td124"><P class="p1 ft6">
        <input type="radio" name="is_isoloation_drained_fully" class="radio_button on_off" data-relate='isoloation' <?php echo $yes_active; ?> value="Yes"/>
                                  Yes
                                  &nbsp;
                                  <input name="is_isoloation_drained_fully" <?php echo $no_active; ?> type="radio" value="No" class="radio_button on_off" data-relate='isoloation'/>
                                  No&nbsp;
                                  <input name="is_isoloation_drained_fully" value="N/A" <?php echo $na_active; ?> type="radio" class="radio_button on_off" data-relate='isoloation' />
                                  N/A</P></TD>
        <TD class="tr7 td123"><P class="p1 ft1">&nbsp;</P></TD>
    </TR>
    <TR>
        <TD class="tr8 td5"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td77"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td89"><P class="p1 ft12">&nbsp;</P></TD>
        <TD colspan=11 class="tr8 td125"><P class="p11 ft15"><input type="checkbox" class="is_isoloation_drained_fully_options" name="is_isoloation_drained_fully_options[]" value="gas entry/exist"  <?php if(in_array('gas entry/exist',$is_isoloation_drained_fully_options)) { ?> checked="checked" <?php } ?>/>Gas entry/exist steam <input class="is_isoloation_drained_fully_options" type="checkbox" name="is_isoloation_drained_fully_options[]" value="water/oil"  <?php if(in_array('water/oil',$is_isoloation_drained_fully_options)) { ?> checked="checked" <?php } ?>/>water/oil and radiation source, if applicable.</P></TD>
        <TD class="tr8 td96"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td97"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td98"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td99"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td109"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td110"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td111"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td96"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td100"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td101"><P class="p1 ft12">&nbsp;</P></TD>
    </TR>
    <TR>
        <TD class="tr12 td0"><P class="p1 ft16">&nbsp;</P></TD>
        <TD rowspan=2 class="tr18 td117"><P class="p11 ft8">4</P></TD>
        <TD class="tr12 td78"><P class="p1 ft16">&nbsp;</P></TD>
        <TD colspan=14 class="tr12 td118"><P class="p11 ft23">Have equipment/pipelines <NOBR>de-pressurized</NOBR> (vent Open) process material(s)</P></TD>
        <TD class="tr12 td86"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td119"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td120"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td121"><P class="p1 ft16">&nbsp;</P></TD>
        
    <?php
      $yes_active='';
      $no_active=$na_active='';
      if(isset($records))
      {
          $is_isoloation_permit=(isset($records['is_isoloation_permit'])) ? $records['is_isoloation_permit'] : '';
          
          if($is_isoloation_permit=='No') 
          $no_active='checked';
          else if($is_isoloation_permit=='N/A')
          $na_active='checked';
          else
          $yes_active='checked';
      }
      else
      $na_active='checked';
     ?>
        
        <TD colspan=2 rowspan=2 class="tr18 td124"><P class="p1 ft6"><input type="radio" name="is_isoloation_permit" class="radio_button on_off" data-relate='isoloation' <?php echo $yes_active; ?> value="Yes"/>
                                  Yes
                                  &nbsp;
                                  <input name="is_isoloation_permit" <?php echo $no_active; ?> type="radio" value="No" class="radio_button on_off" data-relate='isoloation'/>
                                  No&nbsp;
                                  <input name="is_isoloation_permit" value="N/A" <?php echo $na_active; ?> type="radio" class="radio_button on_off" data-relate='isoloation' />
                                  N/A</P></TD>
        <TD class="tr12 td123"><P class="p1 ft16">&nbsp;</P></TD>
    </TR>
    <TR>
        <TD class="tr15 td0"><P class="p1 ft18">&nbsp;</P></TD>
        <TD class="tr15 td78"><P class="p1 ft18">&nbsp;</P></TD>
        <TD colspan=6 rowspan=2 class="tr9 td126"><P class="p11 ft13">emptied out and drained fully?</P></TD>
        <TD class="tr15 td127"><P class="p1 ft18">&nbsp;</P></TD>
        <TD class="tr15 td84"><P class="p1 ft18">&nbsp;</P></TD>
        <TD class="tr15 td85"><P class="p1 ft18">&nbsp;</P></TD>
        <TD class="tr15 td128"><P class="p1 ft18">&nbsp;</P></TD>
        <TD class="tr15 td129"><P class="p1 ft18">&nbsp;</P></TD>
        <TD class="tr15 td122"><P class="p1 ft18">&nbsp;</P></TD>
        <TD class="tr15 td130"><P class="p1 ft18">&nbsp;</P></TD>
        <TD class="tr15 td131"><P class="p1 ft18">&nbsp;</P></TD>
        <TD class="tr15 td86"><P class="p1 ft18">&nbsp;</P></TD>
        <TD class="tr15 td119"><P class="p1 ft18">&nbsp;</P></TD>
        <TD class="tr15 td120"><P class="p1 ft18">&nbsp;</P></TD>
        <TD class="tr15 td121"><P class="p1 ft18">&nbsp;</P></TD>
        <TD class="tr15 td123"><P class="p1 ft18">&nbsp;</P></TD>
    </TR>
    <TR>
        <TD class="tr20 td5"><P class="p1 ft24">&nbsp;</P></TD>
        <TD class="tr20 td77"><P class="p1 ft24">&nbsp;</P></TD>
        <TD class="tr20 td89"><P class="p1 ft24">&nbsp;</P></TD>
        <TD class="tr20 td114"><P class="p1 ft24">&nbsp;</P></TD>
        <TD class="tr20 td92"><P class="p1 ft24">&nbsp;</P></TD>
        <TD class="tr20 td93"><P class="p1 ft24">&nbsp;</P></TD>
        <TD class="tr20 td94"><P class="p1 ft24">&nbsp;</P></TD>
        <TD class="tr20 td95"><P class="p1 ft24">&nbsp;</P></TD>
        <TD class="tr20 td96"><P class="p1 ft24">&nbsp;</P></TD>
        <TD class="tr20 td97"><P class="p1 ft24">&nbsp;</P></TD>
        <TD class="tr20 td98"><P class="p1 ft24">&nbsp;</P></TD>
        <TD class="tr20 td99"><P class="p1 ft24">&nbsp;</P></TD>
        <TD class="tr20 td109"><P class="p1 ft24">&nbsp;</P></TD>
        <TD class="tr20 td110"><P class="p1 ft24">&nbsp;</P></TD>
        <TD class="tr20 td111"><P class="p1 ft24">&nbsp;</P></TD>
        <TD class="tr20 td96"><P class="p1 ft24">&nbsp;</P></TD>
        <TD class="tr20 td100"><P class="p1 ft24">&nbsp;</P></TD>
        <TD class="tr20 td101"><P class="p1 ft24">&nbsp;</P></TD>
    </TR>
    <TR>
        <TD class="tr8 td0"><P class="p1 ft12">&nbsp;</P></TD>
        <TD colspan=16 rowspan=2 class="tr13 td132"  style="vertical-align: top;"><P class="p22 ft5">Comment by the Issuer:</P>&nbsp;I have ensured that all isolations mentioned in clause A, B,C & D are completed. Clear to start the job.</TD>
        <TD class="tr8 td86"><P class="p1 ft12">&nbsp;</P></TD>
        <TD colspan=6 class="tr8 td133"><P class="p5 ft11">Name of the Issuing Authority :</P>

        <?php
              
        $issuing_authority_id2=(isset($records['issuing_authority_id2'])) ? $records['issuing_authority_id2'] : '';
	  
	  	$issuing_authority_id2_approval=(isset($records['issuing_authority_id2_approval'])) ? $records['issuing_authority_id2_approval'] : '';

	  	$issuing_authority_id2_disabled='disabled="disabled"';

        if($approval_status>=4)
        {		
        	if(in_array($issuing_authority_id2_approval,array('','No')) && $remarks_performing_id==$user_id)
        	$issuing_authority_id2_disabled='';

        }	

       # echo 'dD '.$issuing_authority_id2_disabled.' = '.$issuing_authority_id2_approval.' = '.$remarks_performing_id.' == '.$user_id;
        ?>
        <select style="margin:5px;width: 165px;" id="issuing_authority_id2" name="issuing_authority_id2" class="form-control issuing authority" <?php echo $issuing_authority_id2_disabled; ?> >
                                      <option value="">- - Select - -</option>
                                      <?php

      if($issuing_authorities!='')
      {
          foreach($issuing_authorities as $fet)
          {
              $role=$fet['user_role'];
              
              $id=$fet['id'];
              
              $first_name=$fet['first_name'];
              
			  $chk='';
			  
			  $flag=0;
						if($eip_id!=''  && $issuing_authority_id2<=0)
						{
							 if($id!=$user_id)
							 $flag=1;
						}
						else if($issuing_authority_id2>0)
						$flag=1;
		  
		  
		  if($flag==1)
		  {
		  		if($issuing_authority_id2==$id) $chk='selected';
      ?>
                                      <option value="<?php echo $id; ?>" <?php echo $chk; ?>><?php echo $first_name; ?></option>
                                      <?php
              }
          }
      }
       ?>
                                    </select>
        </TD>
    </TR>
    <TR>
        <TD class="tr1 td0"><P class="p1 ft4">&nbsp;</P></TD>
        <TD class="tr1 td86"><P class="p1 ft4">&nbsp;</P></TD>
        <TD class="tr1 td119"><P class="p1 ft4">&nbsp;</P></TD>
        <TD class="tr1 td120"><P class="p1 ft4">&nbsp;</P></TD>
        <TD class="tr1 td121"><P class="p1 ft4">&nbsp;</P></TD>
        <TD class="tr1 td122"><P class="p1 ft4">&nbsp;</P></TD>
        <TD class="tr1 td88"><P class="p1 ft4">&nbsp;</P></TD>
        <TD class="tr1 td123"><P class="p1 ft4">&nbsp;</P></TD>
    </TR>
    
    <TR rowspan="2">
        <TD class="tr10 td5"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr10 td136"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr10 td89"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr10 td8"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr10 td102"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr10 td137"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr10 td90"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr10 td104"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr10 td105"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr10 td114"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr10 td92"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr10 td93"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr10 td94"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr10 td95"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr10 td96"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr10 td97"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr10 td98"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr10 td99"><P class="p1 ft1">&nbsp;</P></TD>
        <TD colspan=5 class="tr10 td138"><P class="p5 ft6">Signature/Date & Time</P>
        <?php  
			
				if($issuing_authority_id2==$user_id && $issuing_authority_id2_approval=='No' && $issuing_authority_id2_date=='')
				$issuing_authority_id2_date=date('d-m-Y H:i:s');
		
		 ?>
         <p><input readonly type="text" class="form-control" name="issuing_authority_id2_date" id="issuing_authority_id2_date" style="width:150px;margin:5px;" value="<?php echo $issuing_authority_id2_date; ?>"  /></p></TD>
        <TD class="tr10 td101"><P class="p1 ft1">&nbsp;</P></TD>
    </TR>
    </TABLE>
    	<?php
		}
		if($approval_status>4)
		{
			
			$performing_authority_id2_approval=(isset($records['performing_authority_id2_approval'])) ? $records['performing_authority_id2_approval'] : '';
			
			
		?>	
   			  <TABLE cellpadding=0 cellspacing=0 class="t1" id="table4" style="width:1024px;" align="center">
    <TR>
        <TD class="tr8 td0"><P class="p1 ft12">&nbsp;</P></TD>
        <TD colspan=6 rowspan=2 class="tr17 td139"><P class="p4 ft5">(E) Performing Authority</P></TD>
        <TD class="tr8 td140"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td141"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td127"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td84"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td85"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td128"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td129"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td122"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td130"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td131"><P class="p1 ft12">&nbsp;</P></TD>
        <TD class="tr8 td86"><P class="p1 ft12">&nbsp;</P></TD>
        <TD colspan=6 class="tr8 td133"><P class="p3 ft11">Name of the Performing Authority :</P>
        <select style="width:150px;" id="performing_authority_id2" name="performing_authority_id2"  
        class="form-control authority performing generate_date" data-date-field="performing_authority_id2_date" data-issue-field="issuing_authority_id2"  data-select-ia="remarks_issuing_id" disabled="disabled" >
                                      <option value="" selected="selected">- - Select - -</option>
                                      <?php
      $performing_authority_id2=(isset($records['performing_authority_id2'])) ? $records['performing_authority_id2'] : $remarks_performing_id;
	  

      if($authorities!='')
      {
          foreach($authorities as $fet)
          {
              $role=$fet['user_role'];
              
              $id=$fet['id'];
              
              $first_name=$fet['first_name'];
              
              $chk='';
              			
						if($performing_authority_id2=='')
						{
							 if($id==$user_id)
							 $flag=1;
							 else
							 $flag=0;
						}
						else
						$flag=1;
					
			  if($flag==1)
			  {
			  
                    if($performing_authority_id2==$id) $chk='selected';
      ?>
                                      <option value="<?php echo $id; ?>" <?php echo $chk; ?>><?php echo $first_name; ?></option>
                                      <?php
              }
          }
      }
       ?>
                                    </select></TD>
    </TR>
    <TR>
        <TD class="tr21 td0"><P class="p1 ft25">&nbsp;</P></TD>
        <TD class="tr21 td140"><P class="p1 ft25">&nbsp;</P></TD>
        <TD class="tr21 td141"><P class="p1 ft25">&nbsp;</P></TD>
        <TD class="tr21 td127"><P class="p1 ft25">&nbsp;</P></TD>
        <TD class="tr21 td84"><P class="p1 ft25">&nbsp;</P></TD>
        <TD class="tr21 td85"><P class="p1 ft25">&nbsp;</P></TD>
        <TD class="tr21 td128"><P class="p1 ft25">&nbsp;</P></TD>
        <TD class="tr21 td129"><P class="p1 ft25">&nbsp;</P></TD>
        <TD class="tr21 td122"><P class="p1 ft25">&nbsp;</P></TD>
        <TD class="tr21 td130"><P class="p1 ft25">&nbsp;</P></TD>
        <TD class="tr21 td131"><P class="p1 ft25">&nbsp;</P></TD>
        <TD class="tr21 td86"><P class="p1 ft25">&nbsp;</P></TD>
        <TD class="tr21 td119"><P class="p1 ft25">&nbsp;</P></TD>
        <TD class="tr21 td120"><P class="p1 ft25">&nbsp;</P></TD>
        <TD class="tr21 td121"><P class="p1 ft25">&nbsp;</P></TD>
        <TD class="tr21 td122"><P class="p1 ft25">&nbsp;</P></TD>
        <TD class="tr21 td88"><P class="p1 ft25">&nbsp;</P></TD>
        <TD class="tr21 td123"><P class="p1 ft25">&nbsp;</P></TD>
    </TR>
    
              
    <TR>
        <TD class="tr2 td0"><P class="p1 ft1">&nbsp;</P></TD>
        <TD colspan=16 class="tr2 td132"><P class="p14 ft8">I understand clause A,B,C&D, I shall maintain conditions as required.</P></TD>
        <TD class="tr2 td86"><P class="p1 ft1">&nbsp;</P></TD>
        <TD colspan=2 class="tr2 td135"></TD>
        <TD class="tr2 td121"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr2 td122"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr2 td88"><P class="p1 ft1">&nbsp;</P></TD>
        <TD class="tr2 td123"><P class="p1 ft1">&nbsp;</P></TD>
    </TR>
    <?php
	
		$performing_authority_id2_date=(isset($records['performing_authority_id2_date'])) ? $records['performing_authority_id2_date'] : '';
		
		if($performing_authority_id2_approval=='No')
		$performing_authority_id2_date=date('d-m-Y H:i');
	?>
    <TR>
        <TD class="tr12 td5"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td136"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td89"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td8"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td102"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td137"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td90"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td104"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td105"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td114"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td92"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td93"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td94"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td95"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td96"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td97"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td98"><P class="p1 ft16">&nbsp;</P></TD>
        <TD class="tr12 td99"><P class="p1 ft16">&nbsp;</P></TD>
        <TD colspan=5 class="tr12 td138"><P class="p3 ft23">Signature/Date & Time:</P><p><input readonly type="text" class="form-control" name="performing_authority_id2_date" id="performing_authority_id2_date" style="width:150px;margin:5px;" value="<?php echo $performing_authority_id2_date; ?>"  /></p></TD>
        <TD class="tr12 td101"><P class="p1 ft16">&nbsp;</P></TD>
    </TR>
    
    </TABLE>  

        <?php
		
		if($approval_status>5)
		{

				 if(isset($records))
                 $temporary_lock_nos=json_decode($records['temporary_lock_nos']);
                 else
                 $temporary_lock_nos=array();

             	$temp_row_count=0;

             	 $temp_row_count=1;
        
                 if(isset($records))
                 {
                 	$temporary_tag_nos=json_decode($records['temporary_tag_nos']);

                 	$temporary_tag_nos_full=json_decode($records['temporary_tag_nos'],true);

                 	if($records['temporary_tag_nos'])
                 	$temp_row_count=count(json_decode($records['temporary_tag_nos'],true));
                 }	
                 else
                 $temporary_tag_nos=array();

             	 if($temp_row_count==0)
             	 {
             	 	$temporary_tag_nos_full=array(1=>'');

             	 	$temp_row_count=1;
             	 }	

    	?>

    	  <input type="hidden" name="total_rows" id="total_rows" value="<?php echo $temp_row_count; ?>" />

   		 <span id="response"></span>


   		 <style type="text/css">

   		 table.category_form_table {
		  border-collapse: collapse;
		 }

		table.category_form_table, table.category_form_table th, table.category_form_table td {
		  border: 1px solid black;
		}
		table.category_form_table td { padding:10px 0 10px 5px; vertical-align: top !important;} 

		table.category_form_table th { height: 35px; text-align: center; text-transform: uppercase; font-size: 10px;}

		.left_no_border { border-left: 1px solid white !important;}

		.temporary_lock { margin-left:30px; float:left;}

         </style>

         <table cellpadding=0 cellspacing=0 class="category_form_table" id="table5" style="width:1024px;" align="center">

         	<tr>
         		<td colspan="12"><b>(F)Temporary Energization & <NOBR>Re-Isolation.Only</NOBR> Same Lock & Tag only to be reused.</b></td>
         	</tr>	

         	<tr>
         		<th colspan="3"></th>         		
         		<th  colspan="3">Energization</th>
         		<th  colspan="6">Re-Isolation</th>
         	</tr>	
         	<tr>
         		<th >Sl.</th>
         		<th>Eqip Tag No</th>
         		<th>LOTO Lock & Tag No</th>
         		<th>Sign of PA</th>
         		<th>Sign of IA</th>
         		<th>Sign of ISO</th>

         		<th>Sign of PA</th>

         		<th>PA Lock No</th>
         		<th>PA Tag No</th>
         		<th>ISO Lock</th>         		
         		<th>Sign of IA</th>
         		<th>Sign of ISO</th>
         	</tr>

         	<?php
                 
 
                 if(isset($records))
                 $temporary_pas=json_decode($records['temporary_pa']);
                 else
                 $temporary_pas=array();

                // print_r($temporary_pas); exit;

               
                 if(isset($records))
                 $temporary_ias=json_decode($records['temporary_ia']);
                 else
                 $temporary_ias=array();

                 if(isset($records))
                 $temporary_isos=json_decode($records['temporary_iso']);
                 else
                 $temporary_isos=array();

                 if(isset($records))
                 $temporary_pa_signdates=json_decode($records['temporary_pa_signdates']);
                 else
                 $temporary_pa_signdates=array();

                 if(isset($records))
                 $temporary_ia_signdates=json_decode($records['temporary_ia_signdates']);
                 else
                 $temporary_ia_signdates=array();

                 if(isset($records))
                 $temporary_iso_signdates=json_decode($records['temporary_iso_signdates']);
                 else
                 $temporary_iso_signdates=array();
				 
                 if(isset($records))
                 $temporary_re_pas=json_decode($records['temporary_re_pa']);
                 else
                 $temporary_re_pas=array();

                 if(isset($records))
                 $temporary_re_ias=json_decode($records['temporary_re_ia']);
                 else
                 $temporary_re_ias=array();

                 if(isset($records))
                 $temporary_re_isos=json_decode($records['temporary_re_iso']);
                 else
                 $temporary_re_isos=array();
				 
                 if(isset($records))
                 $temporary_re_pa_signdates=json_decode($records['temporary_re_pa_signdates']);
                 else
                 $temporary_re_pa_signdates=array();

                 if(isset($records))
                 $temporary_re_ia_signdates=json_decode($records['temporary_re_ia_signdates']);
                 else
                 $temporary_re_ia_signdates=array();

                 if(isset($records))
                 $temporary_re_iso_signdates=json_decode($records['temporary_re_iso_signdates']);
                 else
                 $temporary_re_iso_signdates=array();

             	 if(isset($records))
                 $isolated_re_tagno1=json_decode($records['isolated_re_tagno1']);
                 else
                 $isolated_re_tagno1=array();

             	 if(isset($records))
                 $isolated_re_tagno2=json_decode($records['isolated_re_tagno2']);
                 else
                 $isolated_re_tagno1=array();

             	 if(isset($records))
                 $isolated_re_tagno3=json_decode($records['isolated_re_tagno3']);
                 else
                 $isolated_re_tagno3=array();

				 
				 $isolated_equipment_tag_nos_counts=1;

				

		         if(isset($records))
		         {
		         	$isolated_equipment_tag_nos=json_decode($records['isolated_equipment_tag_nos']);

		         	if($isolated_equipment_tag_nos_counts)
		         	$isolated_equipment_tag_nos_counts=count(json_decode($records['isolated_equipment_tag_nos'],true));		 
		         }	
		         else
		         $isolated_equipment_tag_nos=array();				 
				 
				 $tmp_disabled='disabled="disabled"';
                	
                	$tr_row=1;

                	$temp_tag_array=array();


                    for($i=1;$i<=$temp_row_count;$i++)
				 	//foreach($temporary_tag_nos_full as $i => $val)
                    {
						$temp_disabled_tag_no=$temp_disabled_pa=$temp_disabled_ia=$temp_disabled_iso=$temp_disabled_re_pa=$temp_disabled_re_ia=$temp_disabled_re_iso='';
						
						$disable_row=$is_re=0;
						
						#if($department_id!=$select_department)
						
						$temporary_tag_no=(isset($temporary_tag_nos->$i)) ? $temporary_tag_nos->$i : '';
						
						$temporary_pa_signdate=(isset($temporary_pa_signdates->$i)) ? $temporary_pa_signdates->$i : '';
						
						$temporary_ia_signdate=(isset($temporary_ia_signdates->$i)) ? $temporary_ia_signdates->$i : '';
						
						$temporary_iso_signdate=(isset($temporary_iso_signdates->$i)) ? $temporary_iso_signdates->$i : '';
						
						$temporary_pa=(isset($temporary_pas->$i)) ? $temporary_pas->$i : '';
						
						$temporary_ia=(isset($temporary_ias->$i)) ? $temporary_ias->$i : '';
						
						$temporary_iso=(isset($temporary_isos->$i)) ? $temporary_isos->$i : '';
						
						$temporary_re_pa_signdate=(isset($temporary_re_pa_signdates->$i)) ? $temporary_re_pa_signdates->$i : '';
						
						$temporary_re_ia_signdate=(isset($temporary_re_ia_signdates->$i)) ? $temporary_re_ia_signdates->$i : '';
						
						$temporary_re_iso_signdate=(isset($temporary_re_iso_signdates->$i)) ? $temporary_re_iso_signdates->$i : '';
						
						$temporary_re_pa=(isset($temporary_re_pas->$i)) ? $temporary_re_pas->$i : '';
						
						$temporary_re_ia=(isset($temporary_re_ias->$i)) ? $temporary_re_ias->$i : '';
						
						$temporary_re_iso=(isset($temporary_re_isos->$i)) ? $temporary_re_isos->$i : '';		

						
						$isolated_re_tag1=(isset($isolated_re_tagno1->$i)) ? $isolated_re_tagno1->$i : '';
						$isolated_re_tag2=(isset($isolated_re_tagno2->$i)) ? $isolated_re_tagno2->$i : '';
						$isolated_re_tag3=(isset($isolated_re_tagno3->$i)) ? $isolated_re_tagno3->$i : '';
						
						$isolated_re_tag_disable=$isolated_re_tag3_disable='disabled="disabled"';


						
							
						if($temporary_tag_no!='' && $disable_row==0)
						{
								//Energization PA
								if($user_id==$temporary_pa)
								{
									if($temporary_ia_signdate!='')
									$temp_disabled_ia=$tmp_disabled;
									
									 if($temporary_iso_signdate!='')
									 $temp_disabled_iso=$tmp_disabled;
									 
									 if($temp_disabled_ia!='' || $temp_disabled_iso!='')
									 $temp_disabled_tag_no = $tmp_disabled;
									 
								}
								else 
								$temp_disabled_tag_no=$temp_disabled_pa=$temp_disabled_ia=$temp_disabled_iso=$tmp_disabled;
									
								if($temporary_iso_signdate!=''  && $temporary_ia_signdate!='' && $temporary_re_pa!='')
								{	 
								
										$is_re=1;
									
										if($user_id!=$temporary_re_pa)
										$disable_row=1;
										else if($user_id==$temporary_re_pa)
										{
												$is_re=0;
											
											if($temporary_re_ia_signdate!='')
											 { $temp_disabled_re_ia=$tmp_disabled; $is_re=1; }
											
											 if($temporary_re_iso_signdate!='') { 
											 $temp_disabled_re_iso=$tmp_disabled; $is_re=1; }
										}
										
										if($temporary_re_iso_signdate!='' || $temporary_re_ia_signdate!='')
										{
											$temp_disabled_re_pa=$temp_disabled_re_ia=$temp_disabled_re_iso= $tmp_disabled;
										}			
										
								}
								else
								 { $disable_row=1; }
								#if($user_id!=$temporary_pa || $logged_department_id!=$select_department)
								#$disable_row=1;
								

								#echo 'FF '.$user_id.' = '.$temporary_re_pa;

								if($user_id==$temporary_ia && $temporary_ia_signdate=='')
								{
									$temporary_ia_signdate=date('d-m-Y H:i');
									
									$temp_show=1;
								}
								else if($user_id==$temporary_iso && $temporary_iso_signdate=='' && $temporary_ia_signdate!='')
								{
									$temporary_iso_signdate=date('d-m-Y H:i');
									
									$temp_show=1;
								}
								else if($user_id==$remarks_performing_id && $temporary_re_ia_signdate=='' && $temporary_iso_signdate!='')
								{
									$isolated_re_tag_disable='';
								}
								else if($user_id==$temporary_re_ia && $temporary_re_ia_signdate=='')
								{
									$temporary_re_ia_signdate=date('d-m-Y H:i');
									
									$temp_show=1;
								}
								else if($user_id==$temporary_re_iso && $temporary_re_iso_signdate=='' && $temporary_re_ia_signdate!='')
								{
									$temporary_re_iso_signdate=date('d-m-Y H:i');
									
									$temp_show=1;

									$isolated_re_tag3_disable='';
								}

						}
						else
						{
								if($logged_department_id!=$select_department)
								$disable_row=1;
								else
								$temp_disabled_pa=$temp_disabled_ia=$temp_disabled_iso=$temp_disabled_re_pa=$temp_disabled_re_ia=$temp_disabled_re_iso=$tmp_disabled;
								
						}
						
						if($logged_department_id!=$select_department || $is_re==1)
						$disable_row=1;
						else
						$disable_row=0;
						
							
						
						if($disable_row==0)
						{
							if($temp_disabled_ia!='' || $temp_disabled_iso!='')
							{
								$temp_disabled_pa=$temp_disabled_ia=$temp_disabled_iso=$tmp_disabled;	
							}
						}
						else
						{
							$temp_disabled_tag_no=$temp_disabled_pa=$temp_disabled_ia=$temp_disabled_iso=$temp_disabled_re_pa=$temp_disabled_re_ia=$temp_disabled_re_iso=$tmp_disabled;
							#echo '<br  />F '.$temp_disabled_re_ia.' - '.$i.' - '.$disable_row;					
						}

						#echo '<br /> FFFFF '.$temp_disabled_re_pa;
						if($temporary_iso_signdate!='' && $temporary_ia_signdate!='' && $is_re==0 && $disable_row==0 && $temporary_pa==$user_id)
						{
							$temp_disabled_re_pa=$temp_disabled_re_ia=$temp_disabled_re_iso='';
						}
						
						#echo '<br />FF '.$temp_disabled_re_pa;

						if($temporary_iso_signdate=='' || $temporary_ia_signdate=='')
						$temp_disabled_re_pa=$tmp_disabled;	

						if($temporary_pa!=$user_id)
							$temp_disabled_re_pa=$tmp_disabled;	

						//echo '<br /> AA '.$temporary_pa;
						
						if($temporary_iso_signdate!='' && $temporary_re_iso_signdate!='' && $temporary_ia_signdate!='' && $temporary_re_ia_signdate!='' && $temporary_pa_signdate!='' && $temporary_re_pa_signdate!='')
						$allow_equip=1;
						else
						$allow_equip=0;
						#echo '<br /> Temp : '.$temp_show.' - '.$i.' - '.$temp_disabled_re_pa.' - '.$approval_status;						
						$issuing_authority_id3_date=(isset($records['issuing_authority_id3_date'])) ? $records['issuing_authority_id3_date'] : '';

						if($issuing_authority_id3_date!='')
						$temp_disabled_tag_no=$tmp_disabled;	

						if($user_id==$remarks_performing_id)
						{
							if($temporary_iso_signdate=='' && $temporary_iso!='')
							{
								$temp_disabled_iso='';									
							}	

							if($temporary_ia_signdate=='' && $temporary_ia!='')	
							{
								$temp_disabled_ia='';
							}

							if($temporary_iso_signdate!='' && $temporary_ia_signdate!='') 
							{

								if($temporary_re_ia_signdate=='' && $temporary_re_ia!='')
									$temp_disabled_re_ia='';

								if($temporary_re_iso_signdate=='' && $temporary_re_iso!='')
									$temp_disabled_re_iso='';	

							}

						}


                ?>	
	                <tr class="tr_clone" id="row<?php echo $i; ?>" data-row-id="<?php echo $i; ?>">

	                	<td><span class="temp_row<?php echo $i; ?>"><?php echo $i; ?></span></td>

	                	<td><span id="allow_equip<?php echo $temporary_tag_no; ?>" style="visibility:hidden;"><?php echo $allow_equip; ?></span>
	                		 <select  class="form-control temporary_tags temp_tags<?php echo $i; ?>" name="temporary_tag_nos[<?php echo $i; ?>]" id="temporary_tag_nos[<?php echo $i; ?>]" data-attr="<?php echo $i; ?>" <?php echo $temp_disabled_tag_no; ?> style="width:120px;">
                    				<option value="" selected="selected">Select</option>
                    	<?php
                    		$isolate_type_id_sel='';
							for($tc=1;$tc<=$isolated_equipment_tag_nos_counts;$tc++)
							{
								$prev_tmp_tag_nos=strtoupper((isset($equipment_descriptions->$tc)) ? $equipment_descriptions->$tc : '');

								$tmp_tag_nos=strtoupper((isset($isolated_equipment_tag_nos->$tc)) ? $isolated_equipment_tag_nos->$tc : '');
								
								$isolated_no1=(isset($isolated_tagno1->$tc)) ? $isolated_tagno1->$tc : '';
								
								$isolated_no2=(isset($isolated_tagno2->$tc)) ? $isolated_tagno2->$tc : '';
								
								$isolated_no3=(isset($isolated_tagno3->$tc)) ? $isolated_tagno3->$tc : '';
								
								$isolated_no4=(isset($isolated_tagno4->$tc)) ? $isolated_tagno4->$tc : '';

								#$isolate_type_id=(isset($isolate_types->$tc)) ? $isolate_types->$tc : '';

								$isolate_type_id=(isset($isolated_isolate_types->$tc)) ? $isolated_isolate_types->$tc : '';
								
								
								$loto=strtoupper($isolated_no1.' - '.$isolated_no2.' <br /><br />'.$isolated_no3); #.' - '.$isolated_no4);
								
								$isolated_name_id=(isset($isolated_name->$tc)) ? $isolated_name->$tc : '';

								//($temporary_tag_no==$tmp_tag_nos || $prev_tmp_tag_nos==$temporary_tag_no)
								
								if( $tmp_tag_nos!='' || $prev_tmp_tag_nos!='')
								{
						?>   
                        				<option data-iso="<?php echo $isolated_name_id; ?>" <?php if($temporary_tag_no==$tmp_tag_nos && $approval_status!=6) { $isolate_type_id_sel = $isolate_type_id; ?> selected="selected" <?php } ?> data-loto="<?php echo $loto; ?>" data-isolate-type-id="<?php echo $isolate_type_id; ?>" value="<?php echo $tmp_tag_nos; ?>"><?php echo $tmp_tag_nos; ?></option>
                        <?php
								}
							}
							?>
                    			</select> 
                    	</td>
                    	<td>
                    		 <span class="temporary_lock" id="temporary_lock_nos<?php echo $i; ?>" ><?php echo (isset($temporary_lock_nos->$i)) ? $temporary_lock_nos->$i : ''; ?></span>

                			<input style="margin:5px;"   type="hidden"  class="form-control temporary_lock_nos<?php echo $i; ?>" name="temporary_lock_nos[<?php echo $i; ?>]" id="temporary_lock_nos[<?php echo $i; ?>]"   value="<?php echo (isset($temporary_lock_nos->$i)) ? $temporary_lock_nos->$i : ''; ?>"  />
                        </td>

                        <td> 
                        	<select <?php echo ($temp_disabled_pa!='') ? $temp_disabled_pa : ''; ?> style="width:120px;" id="temporary_pa[<?php echo $i; ?>]" name="temporary_pa[<?php echo $i; ?>]"  class="form-control temporary_pa<?php echo $i; ?> authority_sign" data-date-field="temporary_pa_signdates<?php echo $i; ?>" data-selection="pa" data-attr="<?php echo $i; ?>" >
                                      <option value="" selected="selected">Select</option>
                                      <?php      
										      if($authorities!='')
										      {
										          foreach($authorities as $fet)
										          {
										              $role=$fet['user_role'];
										              
										              $id=$fet['id'];
										              
										              $first_name=$fet['first_name'];
										              
										              $chk='';
													  
													  $flag=1;
													  			if($temporary_pa=='')
																{
																	#if($id!=$user_id)
																	#$flag=0;
																}
																else
																{
																	if($temporary_pa==$id)  { $chk='selected'; $flag=1; }else $flag=0;
																}
																							
													  if($flag==1)
													  {
										                    
										      ?>
										                                      <option value="<?php echo $id; ?>" <?php echo $chk; ?>><?php echo $first_name; ?></option>
										                                      <?php
													  }
										          }
										      }
										       ?>
                        	</select>
							<br />                    
			                <input type="text" readonly="readonly"  class="form-control temporary_pa_signdates<?php echo $i; ?>" name="temporary_pa_signdates[<?php echo $i; ?>]" id="temporary_pa_signdates[<?php echo $i; ?>]" style="margin-bottom:5px;width:120px;font-size:11px;"     value="<?php echo $temporary_pa_signdate; ?>"  />	
			            </td>
			            <td>
					            	<select style="width:120px;" <?php echo ($temp_disabled_ia!='') ? $temp_disabled_ia : ''; ?>  id="temporary_ia[<?php echo $i; ?>]" name="temporary_ia[<?php echo $i; ?>]" class="form-control temporary_ia<?php echo $i; ?> authority_sign" data-selection="ia" data-attr="<?php echo $i; ?>">
		                                                      <option value="">Select</option>
		                                                      <?php
		                                         if($issuing_authorities!='')
		                                          {
		                                              foreach($issuing_authorities as $fet)
		                                              {
		                                                  $role=$fet['user_role'];
		                                                  
		                                                  $id=$fet['id'];
		                                                  
		                                                  $first_name=$fet['first_name'];
		                                                  
		                                                  $chk='';
														  
														  $flag=1;
														  
														  		if($temporary_ia=='')
																{
																	if($user_id==$id)
																	$flag=0;
																}
																else
																{
																	if($temporary_pa==$id)
																	$flag=0;	
																	
																}
																
																
		                                                  if($flag==1)
														  {
		                                                    if($temporary_ia==$id) $chk='selected';
		                                          ?>
		                                                                          <option value="<?php echo $id; ?>" <?php echo $chk; ?>><?php echo $first_name; ?></option>
		                                                                          <?php
														  }
		                                              }
		                                          }
		                       ?>
		                           </select>                                                    
				<br />                    
                <input type="text" readonly="readonly"  class="form-control temporary_ia_signdates<?php echo $i; ?>" name="temporary_ia_signdates[<?php echo $i; ?>]" id="temporary_ia_signdates[<?php echo $i; ?>]" style="margin-bottom:5px;width:120px;font-size:11px;"     value="<?php echo $temporary_ia_signdate; ?>"  />
                </td>

                <td>
		                	<select style="width:120px;"  id="temporary_iso[<?php echo $i; ?>]" name="temporary_iso[<?php echo $i; ?>]" class="form-control authority_iso_sign temporary_iso<?php echo $i; ?>" <?php echo ($temp_disabled_iso!='') ? $temp_disabled_iso : ''; ?>>
		                 <option value="" selected="selected">Select</option>
		                    	<?php
											if(!empty($temporary_iso))
											{
												#$get_iso=$this->public_model->get_data(array('select'=>'id,first_name','where_condition'=>'id = '.$temporary_iso,'table'=>USERS))->row_array();;
												$get_isos=$this->jobs_isolations_model->get_isolation_users(array('isolation_type_id'=>$isolate_type_id_sel))->result_array();

													#echo $this->db->last_query();

													#echo '<pre>'; print_r($get_iso);
													foreach($get_isos as $get_iso)
													{
															if($temporary_iso==$get_iso['id'])
															$sel='selected="selected"';
															else
															$sel='';
											?><option value="<?php echo $get_iso['id'];?>" <?php echo $sel; ?> ><?php echo $get_iso['first_name'];?></option>
															<?php  
													}
											}	
									?>
		                                                     
		                </select>
		                <br />
		                
		                <input type="text" readonly="readonly"  class="form-control temporary_iso_signdates<?php echo $i; ?>" name="temporary_iso_signdates[<?php echo $i; ?>]" id="temporary_iso_signdates[<?php echo $i; ?>]" style="margin-bottom:5px;width:120px;font-size:11px;"     value="<?php echo $temporary_iso_signdate; ?>"  />

		            </td>

		            	<td>
		            		<select <?php echo ($temp_disabled_re_pa!='') ? $temp_disabled_re_pa : ''; ?> style="width:120px;" id="temporary_re_pa[<?php echo $i; ?>]" name="temporary_re_pa[<?php echo $i; ?>]"  class="form-control temporary_re_pa<?php echo $i; ?> authority_sign temporary_re_pa" data-issuing-field="temporary_re_ia<?php echo $i; ?>" data-date-field="temporary_re_pa_signdates<?php echo $i; ?>" data-selection="pa" data-attr="<?php echo $i; ?>" >
                                      <option value="" selected="selected">Select</option>
                                      <?php      
									      if($authorities!='')
									      {
									          foreach($authorities as $fet)
									          {
									              $role=$fet['user_role'];
									              
									              $id=$fet['id'];
									              
									              $first_name=$fet['first_name'];
									              
									              $chk='';
												  
												  $flag=1;
												  			if($temporary_re_pa=='')
															{
																#if($id!=$user_id)
																#$flag=0;
															}
															else
															{
																if($temporary_re_pa==$id)  { $chk='selected'; $flag=1; }else $flag=0;
															}
																						
												  if($flag==1)
												  {
									                    
									      ?>
									                                      <option value="<?php echo $id; ?>" <?php echo $chk; ?>><?php echo $first_name; ?></option>
									                                      <?php
												  }
									          }
									      }
       								  ?>
                                    </select>
								<br />                    
                <input type="text" readonly="readonly"  class="form-control temporary_re_pa_signdates<?php echo $i; ?>" name="temporary_re_pa_signdates[<?php echo $i; ?>]" id="temporary_re_pa_signdates[<?php echo $i; ?>]" style="margin-bottom:5px;width:120px;font-size:11px;"     value="<?php echo $temporary_re_pa_signdate; ?>"  />

                		</td>

                		<td>
                			<input type="text" class="form-control numinput isolation_re_equipment_row1<?php echo $i; ?>" name="isolated_re_tagno1[<?php echo $i; ?>]" id="isolated_re_tagno1[<?php echo $i; ?>]"  value="<?php echo $isolated_re_tag1; ?>" <?php  echo $isolated_re_tag_disable; ?>  style="margin:2px;width:72px;"  />
                		</td>
                		
                		<td>
                			<input type="text" class="form-control numinput isolation_re_equipment_row2<?php echo $i; ?>" name="isolated_re_tagno2[<?php echo $i; ?>]" id="isolated_re_tagno2[<?php echo $i; ?>]"  value="<?php echo $isolated_re_tag2; ?>" <?php  echo $isolated_re_tag_disable; ?>  style="margin:2px;width:72px;"  />
                		</td>

                		<td>
                			<input type="text" class="form-control numinput isolation_re_equipment_row3<?php echo $i; ?>" name="isolated_re_tagno3[<?php echo $i; ?>]" id="isolated_re_tagno3[<?php echo $i; ?>]"  value="<?php echo $isolated_re_tag3; ?>" <?php  echo $isolated_re_tag3_disable; ?>  style="margin:2px;width:72px;"  />
                		</td>


                		<td><?php
				
				if($temporary_re_pa=='')				
				$temp_disabled_re_ia=$temp_disabled_re_iso=$tmp_disabled;
				
				?>
                                   <select style="width:120px;" <?php echo ($temp_disabled_re_ia!='') ? $temp_disabled_re_ia : ''; ?>  id="temporary_re_ia[<?php echo $i; ?>]" name="temporary_re_ia[<?php echo $i; ?>]" class="form-control temporary_re_ia<?php echo $i; ?> authority_sign" data-selection="ia" data-attr="<?php echo $i; ?>">
                                                      <option value="">Select</option>
                                                      <?php
                                         if($issuing_authorities!='')
                                          {
                                              foreach($issuing_authorities as $fet)
                                              {
                                                  $role=$fet['user_role'];
                                                  
                                                  $id=$fet['id'];
                                                  
                                                  $first_name=$fet['first_name'];
                                                  
                                                  $chk='';
												  
												  $flag=1;
												  
												  		if($temporary_re_ia=='')
														{
															if($user_id==$id)
															$flag=0;
														}
														else
														{
															if($temporary_re_pa==$id)
															$flag=0;	
															
														}
														
														
                                                  if($flag==1)
												  {
                                                    if($temporary_re_ia==$id) $chk='selected';
                                          ?>
                                                                          <option value="<?php echo $id; ?>" <?php echo $chk; ?>><?php echo $first_name; ?></option>
                                                                          <?php
												  }
                                              }
                                          }
                       ?>
                                                    </select>
                                                    
<br />
                    
                <input type="text" readonly="readonly"  class="form-control temporary_re_ia_signdates<?php echo $i; ?>" name="temporary_re_ia_signdates[<?php echo $i; ?>]" id="temporary_re_ia_signdates[<?php echo $i; ?>]" style="margin-bottom:5px;width:120px;font-size:11px;"     value="<?php echo $temporary_re_ia_signdate; ?>"  />                                    </td>
                		<td> <select style="width:120px;"  id="temporary_re_iso[<?php echo $i; ?>]" name="temporary_re_iso[<?php echo $i; ?>]" class="form-control authority_iso_sign temporary_re_iso<?php echo $i; ?>" <?php echo ($temp_disabled_re_iso!='') ? $temp_disabled_re_iso : ''; ?>>
                 <option value="" selected="selected">Select</option>
                    	<?php
									if(!empty($isolate_type_id_sel))
									{
											$get_isos=$this->jobs_isolations_model->get_isolation_users(array('isolation_type_id'=>$isolate_type_id_sel))->result_array();
								
											foreach($get_isos as $get_iso)
											{
													if($temporary_re_iso==$get_iso['id'])
													$sel='selected="selected"';
													else
													$sel='';
								?><option value="<?php echo $get_iso['id'];?>" <?php echo $sel; ?> ><?php echo $get_iso['first_name'];?></option>
												<?php  
											}
									}
							?>
                                                     
                </select>
                <br />
                
                <input type="text" readonly="readonly"  class="form-control temporary_re_iso_signdates<?php echo $i; ?>" name="temporary_re_iso_signdates[<?php echo $i; ?>]" id="temporary_re_iso_signdates[<?php echo $i; ?>]" style="margin-bottom:5px;width:120px;font-size:11px;"     value="<?php echo $temporary_re_iso_signdate; ?>"  />

                <b><a href="javascript:void(0);" id="add<?php echo $i; ?>" alt="Add Row" title="Add Row" style="text-align:center;" class="add add_more" data-row-id="<?php echo $i; ?>">+</a>&nbsp;<a href="javascript:void(0);" id="remove<?php echo $i; ?>" style="text-align:center;" class="remove remove_rows" data-row-id="<?php echo $i; ?>" title="Remove Row" title="Remove Row">-</a></b>

            	</td>	
	                </tr>



                <?php
                $tr_row++;
                	}
                ?>
         </table>

                
                <TABLE cellpadding=0 cellspacing=0 class="t1" id="table6" style="width:1024px;" align="center">
                    <TR>
                        <TD width="4" class="tr9 td5"><P class="p1 ft14">&nbsp;</P></TD>
                        <TD colspan=3 class="tr9 td167"><P class="p3 ft20">(G)Work Completion:</P></TD>
                        <TD width="4" class="tr9 td105"><P class="p1 ft14">&nbsp;</P></TD>
                        <TD width="268" class="tr9 td114"><P class="p1 ft14">&nbsp;</P></TD>
                        <TD width="4" class="tr9 td92"><P class="p1 ft14">&nbsp;</P></TD>
                        <TD width="8" class="tr9 td98"><P class="p1 ft14">&nbsp;</P></TD>
                        <TD width="135" class="tr9 td90"><P class="p1 ft14">&nbsp;</P></TD>
                        <TD width="57" class="tr9 td109"><P class="p1 ft14">&nbsp;</P></TD>
                        <TD width="4" class="tr9 td110"><P class="p1 ft14">&nbsp;</P></TD>
                        <TD width="58" class="tr9 td111"><P class="p1 ft14">&nbsp;</P></TD>
                        <TD width="62" class="tr9 td96"><P class="p1 ft14">&nbsp;</P></TD>
                        <TD width="62" class="tr9 td100"><P class="p1 ft14">&nbsp;</P></TD>
                        <TD width="105" class="tr9 td101"><P class="p1 ft14">&nbsp;</P></TD>
                    </TR>
                    <TR>
                        <TD class="tr10 td0"><P class="p1 ft1">&nbsp;</P></TD>
                        <TD colspan=4 class="tr10 td168"><P class="p5 ft5">The work has been completed and area <span class="p5 ft11">cleared</span></P></TD>
                        <TD colspan=3 class="tr10 td168"><P class="p5 ft5">Area Inspected and all Energy sources <span class="p5 ft11">canbe restored</span></P></TD>
                        <TD colspan="7" class="tr8 td90"><P class="p1 ft12">&nbsp;</P> <P class="p4 ft15"><center><strong>Connected Energy Sources restored</strong></center></P></TD>
                    </TR>
                    <TR>
                        <TD class="tr8 td0"><P class="p1 ft12">&nbsp;</P></TD>
                        <TD colspan=3 class="tr8 td170"><P class="p5 ft11">.</P></TD>
                        <TD class="tr8 td172"><P class="p1 ft12">&nbsp;</P></TD>
                        <TD colspan=2 class="tr8 td173"><P class="p5 ft11">&nbsp;</P></TD>
                        <TD class="tr8 td174"><P class="p1 ft12">&nbsp;</P></TD>
                        <TD colspan="3" class="tr9 td90"><P class="p1 ft14">&nbsp;</P><P class="p4 ft33" style="text-align: center;font-weight: bold;">Department</P></TD>
                        <TD colspan="4" class="tr9 td176"><P class="p4 ft15" style="text-align: center;font-weight: bold;">Sign of Isolator with date & time</P></TD>
                    </TR>
                    <TR>
                        <TD class="tr8 td0"><P class="p1 ft12">&nbsp;</P></TD>
                        <TD colspan=3 rowspan=2 class="tr18 td139" valign="top"><P class="p3 ft6">Name of the Performing Authority :</P>
                        <!-- <?php if($user_id!=$remarks_performing_id) { ?> disabled="disabled" <?php } ?> -->
	<?php
                 if(isset($records))
                 $department_completion_users=json_decode($records['department_completion_users']);
                 else
                 $department_completion_users=array();
				 
				 #echo '<pre>'; print_r($department_completion_users);
	
				$performing_authority_id3=(isset($records['performing_authority_id3'])) ? $records['performing_authority_id3'] : '';
	
	?>                        
				<select style="width:150px;" id="performing_authority_id3" name="performing_authority_id3"  
        class="form-control authority performing generate_date" data-date-field="performing_authority_id3_date" data-issue-field="issuing_authority_id3" <?php if($performing_authority_id3>0) { ?> disabled="disabled" <?php } ?>>
                                      <option value="" selected="selected">- - Select - -</option>
                                      <?php
      
      if($authorities!='')
      {
          foreach($authorities as $fet)
          {
              $role=$fet['user_role'];
              
              $id=$fet['id'];
              
              $first_name=$fet['first_name'];
              
              $chk='';
              			
						if($performing_authority_id3<=0)
						{
							 if($id==$user_id)
							 $flag=1;
							 else
							 $flag=0;
						}
						else
						$flag=1;
					
			  if($flag==1)
			  {
			  
                    if($performing_authority_id3==$id) $chk='selected';
      ?>
                                      <option value="<?php echo $id; ?>" <?php echo $chk; ?>><?php echo $first_name; ?></option>
                                      <?php
              }
          }
      }
       ?>
                                    </select>    

  <br />  <br />  <br />  <br />  <br />  <br />

                        </TD>
                        <TD class="tr8 td172"><P class="p1 ft12">&nbsp;</P></TD>
                        <TD colspan=3 rowspan=2 class="tr18 td168" valign="top" style="vertical-align:top;padding-top:30px;">

                        	<?php
      $issuing_authority_id3=(isset($records['issuing_authority_id3'])) ? $records['issuing_authority_id3'] : '';
	  
	  $issuing_authority_id3_approval=(isset($records['issuing_authority_id3_approval'])) ? $records['issuing_authority_id3_approval'] : '';

	  $issuing_authority_3_name=(isset($records['issuing_authority_3_name'])) ? $records['issuing_authority_3_name'] : '';
	  
	  $ia_id3='disabled="disabled"';
	  
	  if($performing_authority_id3>0)
	  {
			if($issuing_authority_id3_approval=='No' && $user_id==$performing_authority_id3) 
			$ia_id3='';
	  }
?>
       

                        	<!-- <P class="p3 ft6">Select Department:

                        		<select <?php echo $ia_id3; ?> style="margin:5px;width: 165px;" id="issuing_authority_id3_dept" name="issuing_authority_id3_dept" class="form-control" >
                                      <option value="">- - Select - -</option>
                                      <?php
                                      foreach($departments as $dept_key => $dept_name):

                                      	echo '<option value="'.$dept_name['id'].'">'.$dept_name['name'].'</option>';
                                      
                                      endforeach;
                                      ?>	
                                </select>      
                        	</p> -->



                        	<P class="p3 ft6">Name of the Issuing Authority :</P>
                 
                                                    
<select <?php echo $ia_id3; ?> style="margin:5px;width: 165px;" id="issuing_authority_id3" name="issuing_authority_id3" class="form-control issuing authority" >
                                      <option value="">- - Select - -</option>
                                      <?php
      if($issuing_authorities!='')
      {
          foreach($issuing_authorities as $fet)
          {
              $role=$fet['user_role'];
              
              $id=$fet['id'];
              
              $first_name=$fet['first_name'];
              
			  $chk='';
			  
			  $flag=0;
						if($eip_id!=''  && $issuing_authority_id3<=0)
						{
							 if($id!=$user_id)
							 $flag=1;
						}
						else if($issuing_authority_id3>0 && $performing_authority_id3!=$id)
						$flag=1;
		  
		  
		  if($flag==1)
		  {
		  		if($issuing_authority_id3==$id) $chk='selected';
      ?>
                                      <option value="<?php echo $id; ?>" <?php echo $chk; ?>><?php echo $first_name; ?></option>
                                      <?php
              }
          }
      }
       ?>
                                    </select>       

                                     

                                                    
                                                    </TD>
                                                    
                                                    <?php $dropdown_css='width:200px;margin:5px;';
														  $text_css='margin:5px;width:140px;';
													 ?>
        <TD colspan=3 class="tr9 td178" style="vertical-align:middle;"><P class="p14 ft34" >1. Electrical</P></TD>
        <TD class="tr9 td176"><P class="p1 ft14">&nbsp;</P></TD>
        <!-- <TD class="tr9 td96"><P class="p1 ft14">&nbsp;</P></TD>
        <TD class="tr9 td100" colspan=""><P class="p1 ft14">&nbsp;</P></TD> -->
        <TD class="tr9 td101" colspan="2" style="vertical-align:middle;">
	<?php
                 if(isset($records))
                 $department_completion_users=json_decode($records['department_completion_users'],true);
                 else
                 $department_completion_users=array();
				 
                 if(isset($records))
                 $department_completion_users_approval_dates=json_decode($records['department_completion_users_approval_dates'],true);
                 else
                 $department_completion_users_approval_dates=array();
				 
				
				 
				# echo '<pre>'; print_r($department_completion_users);
	
				$department_completion_user=(isset($department_completion_users[EIP_ELECTRICAL])) ? $department_completion_users[EIP_ELECTRICAL] : '';
				
				$department_completion_users_approval_date=(isset($department_completion_users_approval_dates[EIP_ELECTRICAL])) ? $department_completion_users_approval_dates[EIP_ELECTRICAL] : '';
				
				$dept_electrical_valid=0;
				
				$electrical_disable='disabled="disabled"';
				
				if($performing_authority_id3>0)
				{
					  if($user_id==$performing_authority_id3 && $department_completion_users_approval_date=='') 
					  $electrical_disable='';
					  
					  if($department_completion_user==$user_id && $department_completion_users_approval_date=='' && $issuing_authority_id3_approval=='Yes')
					  {
						$department_completion_users_approval_date=date('Y-m-d H:i:s');
						
						$temp_show=1;  

						$name_of_ia='';
					  }
				}
	
	?>          
				<select style="<?php echo $dropdown_css; ?>" id="department_completion_users[<?php echo EIP_ELECTRICAL; ?>]" 
                name="department_completion_users[<?php echo EIP_ELECTRICAL; ?>]"  
        class="form-control department_completion_users electrical_dept_completion_user" data-date-field="department_completion_users_approval_dates" data-attr="<?php echo EIP_ELECTRICAL; ?>" <?php echo $electrical_disable; ?> >
      <option value="" selected="selected">- - Select - -</option>
                                      <?php
      
      if($department_isolators)
      {
          foreach($department_isolators as $department_isolator)
          {
              $id=$department_isolator['id'];
              
              $first_name=$department_isolator['first_name'];
			  
			  $dept_id=$department_isolator['department_id'];
              
              $chk='';
			  
			  $flag=0;
			  
			  #if($dept_id==EIP_ELECTRICAL)
			  if(in_array($dept_id,array(EIP_ELECTRICAL,EIP_POWER_PLANT)))
			  {
						if($department_completion_user<=0)
						{
							$dept_electrical_valid=1; $flag=1; 
						}
						else
						$flag=1;
					
					  if($flag==1)
					  {
							
							if($department_completion_user==$id) $chk='selected';
			  ?>
											  <option value="<?php echo $id; ?>" <?php echo $chk; ?>><?php echo $first_name; ?></option>
											  <?php
					  }
			  }
          }
      }
       ?>
                                    </select>     


              </TD>
              <td class="tr9 td101">                      
                                                    <input type="text" readonly="readonly"  class="form-control department_completion_users_approval_dates<?php echo EIP_ELECTRICAL; ?>" name="department_completion_users_approval_dates[<?php echo EIP_ELECTRICAL; ?>]" id="department_completion_users_approval_dates[<?php echo EIP_ELECTRICAL; ?>]" 
                style="<?php echo $text_css; ?>"     value="<?php echo $department_completion_users_approval_date; ?>"  />       

                 <br />
                                    <b style="width:200px;margin:5px;" >Name of the IA</b>
                                    <br />
                                    <input <?php echo $name_of_ia; ?> type="text" class="form-control" name="issuing_authority_3_name" id="issuing_authority_3_name" style="width:200px;margin:5px;"  value="<?php echo $issuing_authority_3_name; ?>"/>            
        
        </TD>
                    </TR>
                    <TR>
                        <TD class="tr23 td0"><P class="p1 ft35">&nbsp;</P></TD>
                        <TD class="tr23 td172"><P class="p1 ft35">&nbsp;</P></TD>
                        <TD colspan=3 rowspan=2 class="tr8 td178"><P class="p14 ft36" style="vertical-align:middle;">2. Instrumentation</P></TD>
                        <TD class="tr23 td179"><P class="p1 ft35">&nbsp;</P></TD>
                        <!-- <TD class="tr23 td122"><P class="p1 ft35">&nbsp;</P>s</TD>
                        <TD class="tr23 td88"><P class="p1 ft35">&nbsp;</P>a</TD> -->
                        <TD class="tr23 td123" colspan="2">				
                        <?php
				$department_completion_user=(isset($department_completion_users[EIP_INSTRUMENTAL])) ? $department_completion_users[EIP_INSTRUMENTAL] : '';
	
				$department_completion_users_approval_date=(isset($department_completion_users_approval_dates[EIP_INSTRUMENTAL])) ? $department_completion_users_approval_dates[EIP_INSTRUMENTAL] : '';

				$dept_instrumental_valid=0;
				
				$instrumental_disable='disabled="disabled"';
				
				if($performing_authority_id3>0)
				{
					  if($user_id==$performing_authority_id3 && $department_completion_users_approval_date=='') 
					  $instrumental_disable='';
					  
					  if($department_completion_user==$user_id && $department_completion_users_approval_date=='' && $issuing_authority_id3_approval=='Yes')
					  {
						$department_completion_users_approval_date=date('Y-m-d H:i:s');
						
						$temp_show=1;  
					  }
				}


?>
				<select style="<?php echo $dropdown_css; ?>" id="department_completion_users[<?php echo EIP_INSTRUMENTAL; ?>]" 
                name="department_completion_users[<?php echo EIP_INSTRUMENTAL; ?>]"  
        class="form-control department_completion_users" data-date-field="department_completion_users_approval_dates" data-attr="<?php echo EIP_INSTRUMENTAL; ?>"  <?php echo $instrumental_disable; ?>>
        
      <option value="" selected="selected">- - Select - -</option>
                                      <?php
      
      if($department_isolators)
      {
          foreach($department_isolators as $department_isolator)
          {
              $id=$department_isolator['id'];
              
              $first_name=$department_isolator['first_name'];
			  
			  $dept_id=$department_isolator['department_id'];
              
              $chk='';
			  
			  $flag=0;
			  
			  #if($dept_id==EIP_INSTRUMENTAL)
			  #if(in_array($dept_id,array(EIP_INSTRUMENTAL,EIP_POWER_PLANT)))
			  if(in_array($dept_id,array(EIP_INSTRUMENTAL,EIP_ELECTRICAL,EIP_POWER_PLANT)))
			  {
							if($department_completion_user<=0)
							{
								
								  $dept_instrumental_valid=1; $flag=1; 
							}
							else
							$flag=1;
					
						  if($flag==1)
						  {
								
								if($department_completion_user==$id) $chk='selected';
				  ?>
												  <option value="<?php echo $id; ?>" <?php echo $chk; ?>><?php echo $first_name; ?></option>
												  <?php
												  
						  }
			  }
          }
      }
       ?>
      </select>     
</TD>
              <td class="tr23 td123">                      
             <input type="text" readonly="readonly"  class="form-control department_completion_users_approval_dates<?php echo EIP_INSTRUMENTAL; ?>" name="department_completion_users_approval_dates[<?php echo EIP_INSTRUMENTAL; ?>]" id="department_completion_users_approval_dates[<?php echo EIP_INSTRUMENTAL; ?>]" 
                style="<?php echo $text_css; ?>"     value="<?php echo $department_completion_users_approval_date; ?>"  />                   
        </TD>

                    </TR>
                    <TR>
                        <TD class="tr21 td0"><P class="p1 ft25">&nbsp;</P></TD>
                        <TD width="83" class="tr21 td143"><P class="p1 ft25">&nbsp;</P></TD>
                        <TD width="83" class="tr21 td78"><P class="p1 ft25">&nbsp;</P></TD>
                        <TD width="85" class="tr21 td15"><P class="p1 ft25">&nbsp;</P></TD>
                        <TD class="tr21 td172"><P class="p1 ft25">&nbsp;</P></TD>
                        <TD class="tr21 td127"><P class="p1 ft25">&nbsp;</P></TD>
                        <TD class="tr21 td84"><P class="p1 ft25">&nbsp;</P></TD>
                        <TD class="tr21 td174"><P class="p1 ft25">&nbsp;</P></TD>
                        <TD class="tr15 td176"><P class="p1 ft18">&nbsp;</P></TD>
                        <TD class="tr15 td96"><P class="p1 ft18">&nbsp;</P></TD>
                        <TD class="tr15 td100"><P class="p1 ft18">&nbsp;</P></TD>
                        <TD class="tr15 td101"><P class="p1 ft18">&nbsp;</P></TD>
                    </TR>
                    <TR>
                        <TD class="tr8 td0"><P class="p1 ft12">&nbsp;</P></TD>
                        <TD colspan=3 rowspan=2 class="tr24 td170"><P class="p3 ft8"></P></TD>
                        <TD class="tr8 td172"><P class="p1 ft12">&nbsp;</P></TD>
                        <TD colspan=2 rowspan=2 class="tr24 td180"><P class="p3 ft8"></P></TD>
                        <TD class="tr8 td174"><P class="p1 ft12">&nbsp;</P></TD>
                        <TD colspan=3 class="tr9 td178"><P class="p14 ft34">3. Mechanical</P></TD>
                        <TD class="tr9 td176"><P class="p1 ft14">&nbsp;</P></TD>
                        <!-- <TD class="tr9 td96"><P class="p1 ft14">&nbsp;</P></TD>
                        <TD class="tr9 td100"><P class="p1 ft14">&nbsp;</P></TD> -->
                        <TD class="tr9 td101" colspan="2">
                        <?php
				$department_completion_user=(isset($department_completion_users[EIP_MECHANICAL])) ? $department_completion_users[EIP_MECHANICAL] : '';
	
				$department_completion_users_approval_date=(isset($department_completion_users_approval_dates[EIP_MECHANICAL])) ? $department_completion_users_approval_dates[EIP_MECHANICAL] : '';

				$dept_mechanical_valid=0;
				
				$mechanical_disable='disabled="disabled"';
				
				if($performing_authority_id3>0)
				{
					  if($user_id==$performing_authority_id3 && $department_completion_users_approval_date=='') 
					  $mechanical_disable='';
					  
					  if($department_completion_user==$user_id && $department_completion_users_approval_date=='' && $issuing_authority_id3_approval=='Yes')
					  {
						$department_completion_users_approval_date=date('Y-m-d H:i:s');
						
						$temp_show=1;  
					  }
				}
				#echo 'deptar'.$dept_id.' - '.EIP_MECHANICAL.' - '.EIP_POWER_PLANT;
?>
                        
				<select style="<?php echo $dropdown_css; ?>" id="department_completion_users[<?php echo EIP_MECHANICAL; ?>]" 
                name="department_completion_users[<?php echo EIP_MECHANICAL; ?>]"  
        class="form-control department_completion_users" data-date-field="department_completion_users_approval_dates" data-attr="<?php echo EIP_MECHANICAL; ?>"  <?php echo $mechanical_disable; ?>>
        
      <option value="" selected="selected">- - Select - -</option>
                                      <?php
      
      if($department_isolators)
      {
          foreach($department_isolators as $department_isolator)
          {
              $id=$department_isolator['id'];
              
              $first_name=$department_isolator['first_name'];
			  
			  $dept_id=$department_isolator['department_id'];
              
              $chk='';
			  
			  $flag=0;
						if($department_completion_user<=0)
						{
							  $dept_mechanical_valid=1; $flag=1;
						}
						else
						$flag=1;
					
			  #if($flag==1 && $dept_id==EIP_MECHANICAL)
			  if(in_array($dept_id,array(EIP_MECHANICAL)) && $flag==1)					
			  {
			  
                    if($department_completion_user==$id) $chk='selected';
      ?>
                                      <option value="<?php echo $id; ?>" <?php echo $chk; ?>><?php echo $first_name; ?></option>
                                      <?php
              }
          }
      }
       ?>
                                    </select>     </TD>
                                                  <td class="tr9 td178">                      
                                                    <input type="text" readonly="readonly"  class="form-control department_completion_users_approval_dates<?php echo EIP_MECHANICAL; ?>" name="department_completion_users_approval_dates[<?php echo EIP_MECHANICAL; ?>]" id="department_completion_users_approval_dates[<?php echo EIP_MECHANICAL; ?>]" 
                style="<?php echo $text_css; ?>"     value="<?php echo $department_completion_users_approval_date; ?>"  />                   
        
        </TD>

                    </TR>
                    <TR>
                        <TD class="tr10 td0"><P class="p1 ft1">&nbsp;</P></TD>
                        <TD class="tr10 td172"><P class="p1 ft1">&nbsp;</P></TD>
                        <TD class="tr10 td174"><P class="p1 ft1">&nbsp;</P></TD>
                        <TD colspan=3 class="tr8 td178"><P class="p14 ft37">4. Utilities</P></TD>
                        <TD class="tr8 td176"><P class="p1 ft12">&nbsp;</P></TD>
                        <!--<TD class="tr8 td96"><P class="p1 ft12">&nbsp;</P></TD>
                        <TD class="tr8 td100"><P class="p1 ft12">&nbsp;</P></TD>-->
                        <TD class="tr8 td101" colspan="2">
                        <?php
				$department_completion_user=(isset($department_completion_users[EIP_UTILITIES])) ? $department_completion_users[EIP_UTILITIES] : '';
	
				#$department_completion_users_approval_date=(isset($department_completion_users_approval_dates['department_completion_users_approval_date'][EIP_UTILITIES])) ? $department_completion_users_approval_dates['department_completion_users_approval_date'][EIP_UTILITIES] : '';

				$department_completion_users_approval_date=(isset($department_completion_users_approval_dates[EIP_UTILITIES])) ? $department_completion_users_approval_dates[EIP_UTILITIES] : '';
				
				$dept_utilities_valid=0;
				
				$utilities_disable='disabled="disabled"';
				
				if($performing_authority_id3>0)
				{
					  if($user_id==$performing_authority_id3 && $department_completion_users_approval_date=='') 
					  $utilities_disable='';
					  
					  if($department_completion_user==$user_id && $department_completion_users_approval_date=='' && $issuing_authority_id3_approval=='Yes')
					  {
						$department_completion_users_approval_date=date('Y-m-d H:i:s');
						
						$temp_show=1;  
					  }
				}
				

?>
                        
				<select style="<?php echo $dropdown_css; ?>" id="department_completion_users[<?php echo EIP_UTILITIES; ?>]" 
                name="department_completion_users[<?php echo EIP_UTILITIES; ?>]"  
        class="form-control department_completion_users" data-date-field="department_completion_users_approval_dates" data-attr="<?php echo EIP_UTILITIES; ?>" <?php echo $utilities_disable; ?> >
        
      <option value="" selected="selected">- - Select - -</option>
                                      <?php
      
      if($department_isolators)
      {
          foreach($department_isolators as $department_isolator)
          {
              $id=$department_isolator['id'];
              
              $first_name=$department_isolator['first_name'];
			  
			  $dept_id=$department_isolator['department_id'];
              
              $chk='';
			  
			  $flag=0;
						if($department_completion_user<=0)
						{
							#if($dept_id==EIP_UTILITIES)
							 #{ 
							 	$dept_utilities_valid=1; $flag=1; #}
						}
						else
						$flag=1;
					
			  #if($flag==1 && $dept_id==EIP_UTILITIES)
			   if(in_array($dept_id,array(EIP_UTILITIES)) && $flag==1)		
			  {
			  		
                    if($department_completion_user==$id) $chk='selected';
      ?>
                                      <option value="<?php echo $id; ?>" <?php echo $chk; ?>><?php echo $first_name; ?></option>
                                      <?php
              }
          }
      }
       ?>
                                    </select>     </TD>
                                                  <td class="tr8 td178">                      
                                                    <input type="text" readonly="readonly"  class="form-control department_completion_users_approval_dates<?php echo EIP_UTILITIES; ?>" name="department_completion_users_approval_dates[<?php echo EIP_UTILITIES; ?>]" id="department_completion_users_approval_dates[<?php echo EIP_UTILITIES; ?>]" 
                style="<?php echo $text_css; ?>"     value="<?php echo $department_completion_users_approval_date; ?>"  />                   
        </TD>
                    </TR>
                    <TR>
                        <TD class="tr7 td5"><P class="p1 ft1">&nbsp;</P></TD>
                        <TD colspan=3 class="tr7 td181"><P class="p3 ft8">Signature/Date & Time:</P>
         <p><input readonly type="text" class="form-control" name="performing_authority_id3_date" id="performing_authority_id3_date" style="width:150px;margin:5px;" value="<?php echo (isset($records['performing_authority_id3_date'])) ? $records['performing_authority_id3_date'] : ''; ?>"  /></p>                        
                        
                        </TD>
                        <TD class="tr7 td182"><P class="p1 ft1">&nbsp;</P></TD>
                        <TD colspan=2 class="tr7 td183"><P class="p3 ft8">Signature/Date & Time:</P>
        <?php  $issuing_authority_id3_date=(isset($records['issuing_authority_id3_date'])) ? $records['issuing_authority_id3_date'] : '';
			
				if($issuing_authority_id3==$user_id && $issuing_authority_id3_approval=='No' && $issuing_authority_id3_date=='')
				$issuing_authority_id3_date=date('d-m-Y H:i');
		
		 ?>
         <p><input readonly type="text" class="form-control" name="issuing_authority_id3_date" id="issuing_authority_id3_date" style="width:150px;margin:5px;" value="<?php echo $issuing_authority_id3_date; ?>"  /></p>                        
                        </TD>
                        <TD class="tr7 td184"><P class="p1 ft1">&nbsp;</P></TD>
                        <TD colspan=3 class="tr7 td178">5. Process</TD>
                        <TD class="tr7 td176"><P class="p1 ft1">&nbsp;</P></TD>
                        <!-- <TD class="tr7 td96"><P class="p1 ft1">&nbsp;</P></TD>
                        <TD class="tr7 td100"><P class="p1 ft1">&nbsp;</P></TD> -->
                        <TD class="tr7 td101" colspan="2">                        
                        
                        <?php
				$department_completion_user=(isset($department_completion_users[EIP_PROCESS])) ? $department_completion_users[EIP_PROCESS] : '';
	
				#$department_completion_users_approval_date=(isset($department_completion_users_approval_dates['department_completion_users_approval_date'][EIP_PROCESS])) ? $department_completion_users_approval_dates['department_completion_users_approval_date'][EIP_PROCESS] : '';

				$department_completion_users_approval_date=(isset($department_completion_users_approval_dates[EIP_PROCESS])) ? $department_completion_users_approval_dates[EIP_PROCESS] : '';
				
				$dept_process_valid=0;
				
				$process_disable='disabled="disabled"';
				

				#echo '<pre>Anand'.EIP_PROCESS; print_r($department_completion_users_approval_dates);
				#echo 'Result : '.$department_completion_user.' == '.$user_id.' && '.$department_completion_users_approval_date.' = '.$issuing_authority_id3_approval;



				if($performing_authority_id3>0)
				{
					  if($user_id==$performing_authority_id3 && $department_completion_users_approval_date=='') 
					  $process_disable='';
					  
					  if($department_completion_user==$user_id && $department_completion_users_approval_date=='' && $issuing_authority_id3_approval=='Yes')
					  {
						$department_completion_users_approval_date=date('Y-m-d H:i:s');
						
						$temp_show=1;  
					  }
				}
				#echo 'deptar'.$dept_id.' - '.EIP_PROCESS.' - '.EIP_POWER_PLANT;

?>
                        
				<select style="<?php echo $dropdown_css; ?>" id="department_completion_users[<?php echo EIP_PROCESS; ?>]" 
                name="department_completion_users[<?php echo EIP_PROCESS; ?>]"  
        class="form-control department_completion_users" data-date-field="department_completion_users_approval_dates" data-attr="<?php echo EIP_PROCESS; ?>" <?php echo $process_disable; ?> >
                        
      <option value="" selected="selected">- - Select - -</option>
                                      <?php
      
      if($department_isolators)
      {
          foreach($department_isolators as $department_isolator)
          {
              $id=$department_isolator['id'];
              
              $first_name=$department_isolator['first_name'];
			  
			  $dept_id=$department_isolator['department_id'];
              
              $chk='';
			  
			  $flag=0;
						if($department_completion_user<=0)
						{
							#if($dept_id==EIP_PROCESS)
							 #{ 
							 	$dept_process_valid=1; $flag=1;# }
						}
						else
						$flag=1;
					
			  #if($flag==1 && $dept_id==EIP_PROCESS)			  
			  if(in_array($dept_id,array(EIP_PROCESS,EIP_PROCESS_NEW)) && $flag==1)			
			  {
			  		
                    if($department_completion_user==$id) $chk='selected';
      ?>
                                      <option value="<?php echo $id; ?>" <?php echo $chk; ?>><?php echo $first_name; ?></option>
                                      <?php
              }
          }
      }
       ?>
                                    </select>     </TD>
                                                  <td class="tr7 td178">                      
                                                    <input type="text" readonly="readonly"  class="form-control department_completion_users_approval_dates<?php echo $i; ?>" name="department_completion_users_approval_dates[<?php echo EIP_PROCESS; ?>]" id="department_completion_users_approval_dates[<?php echo EIP_PROCESS; ?>]"  
                style="<?php echo $text_css; ?>"     value="<?php echo $department_completion_users_approval_date; ?>"  />                   
        </TD>

                    </TR>
                    <TR>
                        <TD class="tr7 td0"><P class="p1 ft1">&nbsp;</P></TD>
                        <TD colspan=6 class="tr7 td185"><P class="p19 ft38">Emergency Contact number : Cell : 9865152222/ 3108 / PA system 9</P></TD>
                        <TD colspan=8 class="tr7 td186"><P class="p1 ft38">Ref No: <NOBR>WI-33(P1-14:AM</NOBR> 7) Rev No: 01 Dt. 30.06.2016</P></TD>
                    </TR>
               		
               		 <TR>
                        <TD class="tr7 td0"><P class="p1 ft1">&nbsp;</P></TD>
                        <TD colspan=14 class="tr7 td185"><P class="p19 ft38">Checked with CCR & also at field (forcibly started) to ensure that there is absolutely no supply on the Equipment
                       </P></TD>
                        
                    </TR> 
        </TABLE>    
        <?php
			}
		}
		?>
        
    <?php   
	}
	?>
    	<br />
        
        <div style="margin:5px;">
	<?php
	$show_flag=2;
	$show_final=0;
	$department_user_validation=0;
	if($approval_status==8)
	{
		if(isset($dept_electrical_valid))
		$department_user_validation=$dept_electrical_valid+$department_user_validation;
		
		if(isset($dept_instrumental_valid))
		$department_user_validation=$dept_instrumental_valid+$department_user_validation;
		if(isset($dept_mechanical_valid))
		$department_user_validation=$dept_mechanical_valid+$department_user_validation;
		
		if(isset($dept_utilities_valid))
		$department_user_validation=$dept_utilities_valid+$department_user_validation;

		if(isset($dept_process_valid))
		$department_user_validation=$dept_process_valid+$department_user_validation;
		
	}
	else
	$department_user_validation = 0;
							$label=' Submit';
							
							$submit_value='show';							
	#echo '<br /> A : '.$approval_status.' - '.$user_id.' == '.$remarks_issuing_id;
		  if($eip_id!='' && !in_array($approval_status,array(11,12))) #$approval_status!=8
		  {


			  //If IA approved and PA come back his job
			  if($remarks_issuing_approval=='Yes' && $user_id==$remarks_performing_id && in_array($approval_status,array(2,3,5)))
			  {
				 # $show_final=1; 
				 	if($performing_authority_id2_approval=='Yes' || in_array($approval_status,array(2,3)))
				 		 $show_flag=2;
						 else if($approval_status==5 && $performing_authority_id2_approval=='No')
						 {
								  $label=' Final Submit';
				  
								  $submit_value=3;	
								  
								  $show_flag=2;						

						 }
						 else
						 $show_flag=4;
			  }
			  else if($remarks_issuing_approval=='No' && $user_id==$remarks_issuing_id)
			  #else if($user_id==$remarks_issuing_id)
			  {
			  		$show_flag=22;

			  		if($remarks_issuing_approval=='No')
			  		{
						  $label=' Approve & Submit';
						  
						  $submit_value=2;	
						  
						  $show_flag=2;		
					}	  
			  }
			  else if( ($issuing_authority_id2_approval=='No' && $user_id==$issuing_authority_id2) || (in_array($issuing_authority_id2_approval,array('','No')) && $user_id==$remarks_performing_id))
			  #else if($user_id==$issuing_authority_id2)
			  {		
			  		$show_flag=22;

			  		if($issuing_authority_id2_approval=='No' && $user_id==$issuing_authority_id2)
			  		{
					  $label=' Approve & Submit';
					  
					  $submit_value=2;	
					  
					  $show_flag=2;	
					} 
					else if(in_array($issuing_authority_id2_approval,array('','No')) &&  $user_id==$remarks_performing_id)
					{
						  $label=' Submit';
					  
						  $submit_value=2;	
						  
						  $show_flag=2;	

					}
			  }
			  else if($issuing_authority_id3_approval=='No' && $user_id==$issuing_authority_id3)
			 # else if($user_id==$issuing_authority_id3)
			  {
			  		$show_flag=22;

			  		if($issuing_authority_id3_approval=='No')
			  		{
					  $label=' Approve & Submit';
					  
					  $submit_value=2;	
					  
					  if($job_status_error_msg=='')
					  $show_flag=2;				
					  else
					  $show_flag=22;		
					}
			  }
			  else if($remarks_issuing_approval=='No' && $user_id==$remarks_performing_id)
			  {
				  $show_flag=2;
			  }
			  else if($is_isolators==1 && $approval_status==3)
			  $show_flag=3;
			  else if($logged_department_id!=$select_department)		#else if($user_id!=$remarks_performing_id)
			  $show_flag=0;
			  else if(in_array($approval_status,array(6,7,8,9,10)))
			  $show_flag=2;
			  else  
			  $show_flag=0; 
			  
		  }
		  else
		  $show_flag=0;


		  
			  if($temp_show==1)
			  {
				  $label=' Approve & Submit';
				  
				  $submit_value=$show_flag=2;	
			  }
		  
		  #echo 'FF '.$user_id.' == '.$issuing_authority_id3;
		  #echo '<br /> Show Flag : '.$show_flag.' - '.$approval_status.' - '.$issuing_authority_id3_approval.' - '.$user_id.' == '.$issuing_authority_id3;
	
							if($show_flag==2)
							{
								if($label==' Final Submit')
								   	echo '<p><b>Checked with CCR & also at field (forcibly started) to ensure that there is absolutely no supply on the Equipment</b></p>';
								   
								   if($show_final==0)	
								   echo '<button class="btn btn-sm btn-primary show_button"  value="'.$submit_value.'" type="submit"><i class="fa fa-dot-circle-o"></i> '.$label.'</button>';
							}
							else if($show_flag==3)
								   echo '<button class="btn btn-sm btn-primary show_button"  value="3" type="submit"><i class="fa fa-dot-circle-o"></i> Approve Isolations & Submit</button>';
							else if($show_flag==0 && $eip_id=='')
								   echo '<button class="btn btn-sm btn-primary show_button"  value="1" type="submit"><i class="fa fa-dot-circle-o"></i> Submit</button>';
							if($is_popup=='')
							echo '&nbsp;<a class="btn btn-sm btn-danger" href="'.base_url().'jobs_isolations"><i class="fa fa-ban"> Go Back</i></a>';
							
			if($eip_id>0)
			{	
				
			  $st='';
			  	
			  $final_status_date = (isset($records['final_status_date'])) ? $records['final_status_date'] : '';	
			  if($user_role!='sa')
			  {		
			  	  if($final_status_date=='')
				  $st='visibility:hidden;';

			  }	  
			  else 
			  $st='';
			
			echo '&nbsp;<a href="javascript:void(0);" data-id="'.$eip_id.'" style="float:right;'.$st.'" class="print_out"><i class="fa fa-print"> Print PDF</i></a>';
			}


			
    ?>        
    </div>
            
    </DIV>
		</form>

		</td>
    </tr>
    </table>    
    
<?php  



function generate_time($array_args)
{
	extract($array_args);
	
	$selected_value=(isset($selected_value)) ? $selected_value : '';
	
	$width=(isset($width)) ? $width : '67px';
?>	
	<select name="<?php echo $name; ?>" id="<?php echo $name; ?>"  class="form-control" style="width:<?php echo $width; ?>;">
    	<option value="" selected="selected">Select</option>
	<?php for($i = 0; $i < 24; $i++)
		{
	
			$t=$i ;	#% 12 ? $i % 12 : 12
			
					if($i<=9)
					$i='0'.$i;
			
			
			for($s=0;$s<=45;$s+=15)
			{
					if($s==0)
					$t= ':00';
					else
					$t=':'.$s;
					
					$t=$i.$t;
					
			
					if($t==$selected_value)
					$sel="selected=selected";
					else
					$sel='';
	 ?>
 	 <option value="<?php echo $t; ?>" <?php echo $sel; ?>><?php echo $t; ?></option>
     
	<?php } } ?>
	</select>
<?php	
}

?>   
    
<script type="text/javascript">var base_url='<?php echo base_url(); ?>';</script>    
<script src="<?php echo base_url(); ?>assets/js/jquery-2.1.1.min.js"></script> 
<script type="text/javascript" src="<?php echo base_url(); ?>assets/js/jquery.thickbox.js"></script>
<script type="text/javascript" src="<?php echo base_url(); ?>assets/js/jquery.validate.min.js"></script>
<link href="<?php echo base_url(); ?>assets/css/jquery.thickbox.css" rel="stylesheet" media="screen" type="text/css" />

<!--<link href="<?php echo base_url(); ?>assets/ui/jquery-ui.css" rel="stylesheet"type="text/css" />
<script src="<?php echo base_url(); ?>assets/ui/jquery-ui.js"></script>
<script src="<?php echo base_url(); ?>assets/plugins/select2/js/select2.min.js"></script>-->
<script type="text/javascript" src="<?php echo base_url();?>assets/js/jobs_isolations.js"></script>

<script type="text/javascript">
		
	<?php
	if($eip_id=='')
	{
		//Anand
	?>	
	  $('#work_permit_nos').val(parent.$('#permit_no').val());
	  
	  $('#department_id').val(parent.$('#department_id').val());
	  
	  $('#zone_id').val(parent.$('#zone_id').val());

	  $('#job_descriptions').html('<ol><li style="margin-left:10px;">#'+parent.$('#permit_no').val()+' - '+parent.$('#job_name').val()+'</li></ol>');
	 	
	<?php
	}
	else
	{
		if($remarks_issuing_approval=='No' && $user_id==$remarks_issuing_id) // Step (a) & (b)
		{
		?>	
		$('#remarks_performing_id').attr('disabled',true);
		<?php
		}
		else if($remarks_issuing_approval=='Yes')	//Disable (A) & (B) after getting IA approval
		{
		?>
			$('#table1 :input').attr('disabled',true);

			$('#isolation_table :input').attr('disabled',true);
		<?php
		}
		if($approval_status>3)
		{
		?>
		$('#table2 :input').attr('disabled',true);
		<?php
		}
		if($issuing_authority_id2_date=='' && $user_id!=$issuing_authority_id2)
		{
		?>	
			//$('#table3 :radio,#table3 :checkbox').attr('disabled',true); 
		<?php	
		}
		if($approval_status>=5)	// || $issuing_authority_id2_date==''
		{
		?>
		//$('#table3 :input').attr('disabled',true); 
		<?php
		}
		if($approval_status>=9)#,8,9,10
		{
		?>		
			$('#table5 :input,#table5 select').attr('disabled',true);
		<?php
		}
		if(in_array($approval_status,array(7)))#,8,9,10
		{
		?>
		$('#table6 :input,#table6 select').attr('disabled',true);
		<?php
		}
		if($show_flag==0)
		{
		?>	
		$(':input,select').attr('disabled',true);
		<?php
		}
		if($show_flag==0)
		{
		?>	
		$('#table6 :input,#table6 select,#table6 :input,#table6 select').attr('disabled',true);
		<?php
		}
		if($approval_status>1)
		{
		?>
			$('#table1 :input,#table1 select').attr('disabled',true);
		<?php	
		}
		if($name_of_ia=='')
		{
		?>
			$('#issuing_authority_3_name').removeAttr('disabled');
		<?php
		}
		/*else if($user_id!=$remarks_performing_id)		//No one can edit without creater
		{
		?>
			//$(':input').attr('disabled',true);
		<?php	
		}*/
		
	}
	?>
	
	 var data = new FormData();
    
     data.append('zone_id',$('#zone_id').val());

     var is_checklist=0;

     <?php
     	if($records)
         {
     ?>    	
         	data.append('equipment_descriptions','<?php echo json_encode($equipment_descriptions); ?>');

         	data.append('equipment_tag_nos','<?php echo json_encode($equipment_tag_nos); ?>');

         	data.append('isolate_types','<?php echo json_encode($isolate_types); ?>');

         	data.append('equipment_remarks','<?php echo $equipment_remarks; ?>');

			data.append('equipment_radio','<?php echo $equipment_radio; ?>');

			data.append('remarks_issuing_date','<?php echo $remarks_issuing_date; ?>');

			data.append('remarks_issuing_approval','<?php echo $remarks_issuing_approval; ?>');
     <?php			
         }
		 
     ?>    
	  $.ajax({
			url: base_url+'eip_checklists/ajax_get_eip_checklists/',
			type: 'POST',
			"beforeSend": function(){  },
			data: data,
			async: false,
			cache: false,
			dataType: 'json',
			processData: false, // Don't process the files
			contentType: false, // Set content type to false as jQuery will tell the server its a query string request
			success: function(data, textStatus, jqXHR)
			{
				$('#isolation_table').html(data.rows);		

				is_checklist=data.num_rows; 	

				console.log('SS');
			},
			error: function(jqXHR, textStatus, errorThrown)
			{
				$('#isolation_table').html('Failure');	

				is_checklist=data.num_rows; 	
			}
		});		

	  	console.log('checklist '+is_checklist);

		var temporary_ia='';
		<?php 

		$flag='true';
		
		$validate='';
		
		if($approval_status>5)
		{
			for($i=1;$i<=$temp_row_count;$i++)
			//foreach($temporary_tag_nos_full as $i => $val)
			{
				$validate.=",'temporary_pa[".$i."]':{required:function(element) {
													if($('input[name=\"temporary_tag_nos[".$i."]\"]').val()!='') 
													return ".$flag."; 
													else return false;
												 }}";
				$validate.=",'temporary_ia[".$i."]':{required:function(element) {
													if($('input[name=\"temporary_tag_nos[".$i."]\"]').val()!='') 
													return ".$flag."; 
													else return false;
												 }}";		
				$validate.=",'temporary_iso[".$i."]':{required:function(element) {
													if($('input[name=\"temporary_tag_nos[".$i."]\"]').val()!='') 
													return ".$flag."; 
													else return false;
												 }}";			

				$validate.=",'isolated_re_tagno1[".$i."]':{required:function(element) {
													if($('input[name=\"temporary_re_pa[".$i."]\"]').val()!='') 
													return ".$flag."; 
													else return false;
												 }}";					

				$validate.=",'isolated_re_tagno2[".$i."]':{required:function(element) {
													if($('input[name=\"temporary_re_pa[".$i."]\"]').val()!='') 
													return ".$flag."; 
													else return false;
												 }}";					

				$validate.=",'isolated_re_tagno3[".$i."]':{required:function(element) {
													if($('input[name=\"temporary_re_pa[".$i."]\"]').val()!='') 
													return ".$flag."; 
													else return false;
												 }}";													 

				$validate.=",'temporary_re_iso[".$i."]':{required:function(element) {
													if($('input[name=\"temporary_re_pa[".$i."]\"]').val()!='') 
													return ".$flag."; 
													else return false;
												 }}";																	 									 
				$validate.=",'temporary_re_ia[".$i."]':{required:function(element) {
													if($('input[name=\"temporary_re_pa[".$i."]\"]').val()!='') 
													return ".$flag."; 
													else return false;
												 }}";		
			}
				
		}
		
		#$validate='';
		
		for($i=2;$i<=$total_equipment_tags;$i++)
		{
			$validate.=",'equipment_descriptions[".$i."]':{required:function(element) {
												if($('input[name=\"equipment_descriptions[".$i."]\"]').val()!='' || $('input[name=\"equipment_tag_nos[".$i."]\"]').val()!='' || $('select[name=\"isolate_types[".$i."]\"]').val()!='') 
												return ".$flag."; 
												else return false;
											 }}";
			$validate.=",'equipment_tag_nos[".$i."]':{required:function(element) {
												if($('input[name=\"equipment_descriptions[".$i."]\"]').val()!='' || $('input[name=\"equipment_tag_nos[".$i."]\"]').val()!='' || $('select[name=\"isolate_types[".$i."]\"]').val()!='') 
												return ".$flag."; 
												else return false;
											 }}";			
			$validate.=",'isolate_types[".$i."]':{required:function(element) {
												if($('input[name=\"equipment_descriptions[".$i."]\"]').val()!='' || $('input[name=\"equipment_tag_nos[".$i."]\"]').val()!='' || $('select[name=\"isolate_types[".$i."]\"]').val()!='') 
												return ".$flag."; 
												else return false;
											 }}";	
				if(in_array($approval_status,array(2,3)))
				{
					$validate.=",'isolated_equipment_tag_nos[".$i."]':{required:function(element) {
														if($('select[name=\"isolated_equipment_descriptions[".$i."]\"]').val()!='' || $('select[name=\"isolated_isolate_types[".$i."]\"]').val()!='' || $('input[name=\"isolated_tagno1[".$i."]\"]').val()!='' || $('input[name=\"isolated_tagno2[".$i."]\"]').val()!='' || $('select[name=\"isolated_name[".$i."]\"]').val()!='') 
														return ".$flag."; 
														else return false;
													 }}";			
					$validate.=",'isolated_equipment_descriptions[".$i."]':{required:function(element) {
														if($('input[name=\"isolated_equipment_tag_nos[".$i."]\"]').val()!='' || $('select[name=\"isolated_isolate_types[".$i."]\"]').val()!='' || $('input[name=\"isolated_tagno1[".$i."]\"]').val()!='' || $('input[name=\"isolated_tagno2[".$i."]\"]').val()!='' || $('select[name=\"isolated_name[".$i."]\"]').val()!='') 
														return ".$flag."; 
														else return false;
												}}";
					$validate.=",'isolated_isolate_types[".$i."]':{required:function(element) {
														if($('input[name=\"isolated_equipment_tag_nos[".$i."]\"]').val()!='' || $('select[name=\"isolated_equipment_descriptions[".$i."]\"]').val()!='' || $('input[name=\"isolated_tagno1[".$i."]\"]').val()!='' || $('input[name=\"isolated_tagno2[".$i."]\"]').val()!='' || $('select[name=\"isolated_name[".$i."]\"]').val()!='') 
														return ".$flag."; 
														else return false;
													 }}";	
					$validate.=",'isolated_tagno1[".$i."]':{required:function(element) {
														if($('input[name=\"isolated_equipment_tag_nos[".$i."]\"]').val()!='' || $('select[name=\"isolated_isolate_types[".$i."]\"]').val()!='' || $('select[name=\"isolated_equipment_descriptions[".$i."]\"]').val()!='' || $('input[name=\"isolated_tagno2[".$i."]\"]').val()!='' || $('select[name=\"isolated_name[".$i."]\"]').val()!='') 
														return ".$flag."; 
														else return false;
													 }}";	
					$validate.=",'isolated_tagno2[".$i."]':{required:function(element) {
														if($('input[name=\"isolated_equipment_tag_nos[".$i."]\"]').val()!='' || $('select[name=\"isolated_isolate_types[".$i."]\"]').val()!='' || $('input[name=\"isolated_tagno1[".$i."]\"]').val()!='' || $('select[name=\"isolated_equipment_descriptions[".$i."]\"]').val()!='' || $('select[name=\"isolated_name[".$i."]\"]').val()!='') 
														return ".$flag."; 
														else return false;
													 }}";	
					$validate.=",'isolated_name[".$i."]':{required:function(element) {
														if($('input[name=\"isolated_equipment_tag_nos[".$i."]\"]').val()!='' || $('select[name=\"isolated_isolate_types[".$i."]\"]').val()!='' || $('input[name=\"isolated_tagno1[".$i."]\"]').val()!='' || $('input[name=\"isolated_tagno2[".$i."]\"]').val()!='' || $('select[name=\"isolated_equipment_descriptions[".$i."]\"]').val()!='') 
														return ".$flag."; 
														else return false;
													 }}";	

					/*if($show_flag==3)
					{*/								 
					$validate.=",'isolated_tagno3[".$i."]':{required:function(element) {
														if($('input[name=\"isolated_name_approval_datetime[".$i."]\"]').val()!='') 
														return ".$flag."; 
														else return false;
													 }}";	


					$validate.=",'isolated_ia_name[".$i."]':{required:function(element) {
														if($('input[name=\"isolated_name_approval_datetime[".$i."]\"]').val()!='') 
														return ".$flag."; 
														else return false;
													 }}";									 
					//}				
				}						 		
		}
		
		#$validate='';
		 ?>

			$.validator.addClassRules('authority_sign', {
    		required: true,
  			});

  			$.validator.addClassRules('authority_iso_sign', {
    		required: true,
  			});

    		$("#job_form").validate({ 
			rules: {
				date_end:{required:<?php echo $flag; ?>},
				time_end: { required:<?php echo $flag; ?> },
				section: { required:<?php echo $flag; ?> },
				area: { required:<?php echo $flag; ?> },
				remarks_issuing_id: { required:<?php echo $flag; ?> },
				remarks_issuing_authority_1 : { required : <?php echo $flag; ?> },
				remarks_issuing_authority_2 : { required : <?php echo $flag; ?> },
				remarks_performing_id: { required:<?php echo $flag; ?> },
				'equipment_descriptions[1]': { required:<?php echo $flag; ?>},
				'equipment_tag_nos[1]': { required:<?php echo $flag; ?>},
				'isolate_types[1]': { required:<?php echo $flag; ?>},
				'isolated_equipment_descriptions[1]': { required: <?php echo $flag; ?> },
				'isolated_equipment_tag_nos[1]': { required: <?php echo $flag; ?> },
				'isolated_isolate_types[1]': { required: <?php echo $flag; ?> },
				'isolated_tagno1[1]': { required: <?php echo $flag; ?> },
				'isolated_tagno2[1]' : { required: <?php echo $flag; ?> },
				'isolated_tagno3[1]': { required: <?php echo $flag; ?> },
				'isolated_ia_name[1]' : { required: <?php echo $flag; ?> },
				'isolated_name[1]': { required: <?php echo $flag; ?> },
				'performing_authority_id2': { required: true },
				'issuing_authority_id2': { required : true },
				'performing_authority_id3': { required: true },
				'issuing_authority_id3': { required : true },
				'issuing_authority_3_name': { required : function(element) 
				{

								if($('select[name="department_completion_users[<?php echo $eip_completed_departments[0]; ?>]"]').val()!='')
									return true;
								else
									return false;
				} }
				<?php echo $validate;
					if($approval_status==4)
					{
						echo ',"is_isoloation_drained_fully_options[]":
					      { required:function(element)
						         { 
								  	if($(\'input[name="is_isoloation_drained_fully"]:checked\').val()=="Yes")
									return '.$flag.';
									else
									return false;								  	
								  }
						  }';
					}
					if(in_array($approval_status,array(8,6)))
					{	

						for($e=0;$e<count($eip_completed_departments);$e++)
						{
							echo ",'department_completion_users[".$eip_completed_departments[$e]."]':
					     	 { required:function(element)
						         { 
						         	var value = $('.department_completion_users').filter(function () {
    								return this.value == '';
  									});

  									var selected_department=value.length;

  									var total_department = ".count($eip_completed_departments).";  									
									var cnt=$('select[name=\"department_completion_users[".$eip_completed_departments[$e]."]\"]').children('option').length;
								  	if($('#performing_authority_id3').val()!='' && cnt>1 && selected_department==total_department)
									return ".$flag.";
									else
									return false;								  	
								  }
						  }";
						}
					}
				 ?>
            },
			messages:
			{
				date_end : {required:'Required' },
				time_end:{required:'Required' },
				section:{required:'Required' },
				area:{required:'Required' },
				remarks_issuing_id:{required:'Required' },
				remarks_performing_id:{required:'Required' }
				
			},
		errorPlacement: function(error,element){
            error.appendTo(element.parent().parent());                        
        },       		
        submitHandler:function(){

        	var is_error='';

        	var data = new FormData();			

        	console.clear();

        	console.log('IS Cheklist '+is_checklist);
        	if(is_checklist>0)
        	{
        		//$('select[name^="isolate_types"]').each(function() {
        		$('input[name^="equipment_radio"]:checked').each(function() {	
        			var data_id=$(this).attr('data-id');

        			var data_type=$(this).attr('data-type');

        			//console.log('DAta id '+data_id + ' = '+$(this).val()+' = '+$(this).attr('name'));
        			if($(this).val()=='Yes' && $(this).attr('disabled')!='disabled')
        			{
	        			if($('.equipment_descriptions'+data_id).val()=='')
	        			{
	        				$('.equipment_descriptions'+data_id).attr('class','form-control error equipment_descriptions'+data_id);

	        				is_error=1;
	        				//console.log('Error '+data_id);
	        			}	

	        			if(data_type=='text')
	        			{
							if($('.equipment_tag_no'+data_id).val()=='')
		        			{
		        				$('.equipment_tag_no'+data_id).attr('class','form-control error equipment_tag_no'+data_id);

		        				is_error=1;

		        				console.log('Error '+data_id);
		        			}	

		        			if($('.equipment_remarks'+data_id).val()=='')
		        			{
		        				$('.equipment_remarks'+data_id).attr('class','form-control equipment_remarks'+data_id+' error');

		        				is_error=1;
		        				//console.log('Error '+data_id);
		        			}

	        			}
	        			else
	        				$('.equipment_remarks'+data_id).attr('class','form-control equipment_remarks'+data_id);

	        			if($('.isolate_type'+data_id).val()=='')
	        			{
	        				$('.isolate_type'+data_id).attr('class','form-control isolate_type'+data_id+' error');

	        				is_error=1;
	        				//console.log('Error '+data_id);
	        			}	

	        			

	        			data.append($(this).attr('name'),$(this).val());
	        		}
	        		else
	        		{
	        			$('.isolate_type'+data_id).attr('class','form-control isolate_type'+data_id);

	        			$('.equipment_descriptions'+data_id).attr('class','form-control equipment_descriptions'+data_id);

	        			 if($(this).attr('disabled')!='disabled')
	        			 {	
		        			if(data_type=='text')
		        			$('.equipment_tag_no'+data_id).attr('class','form-control equipment_tag_no'+data_id);	
		        			else
		        			{
			        			if($('.equipment_remarks'+data_id).val()=='')
			        			{
			        				$('.equipment_remarks'+data_id).attr('class','form-control equipment_remarks'+data_id+' error');

			        				is_error=1;
			        				//console.log('Error '+data_id);
			        			}	
			        		}	
			        	}	
	        			data.append($(this).attr('name'),$(this).val());
	        		}	
        		});	

        	}

        /*	console.log('IS END '+is_error);

        	return false;*/
			
			if(is_error!='')
			{
				return false;
			}
			else
			{
				var is_flag=0;

				checker={};

				var is_check=$('.equip_desc').filter(function () 
				{
					if($(this).val()!='')
					{
						//var allow_equip=$('#allow_equip'+val).html(); && allow_equip==0
						
						if(checker[this.value])
						{
							alert('You already selected this equipment. Please try different one');
							
							is_flag=1;
						}
						else
							checker[this.value] = true;
					}

				});

				if(is_flag==1)
				{
					return false;
				}
			}	
			//alert($("#job_form button[type='submit']").val()); return false;
			
			var submit_value=$("#job_form button[type='submit']").val();
              // $("#job_form button[type='submit']").html("<i class=\"fa fa-dot-circle-o\"></i> Processing");
                //form.submit();
					
			var $inputs = $('form#job_form :input[type=text],form#job_form :input[type=hidden],select,form#job_form :input[type=radio],form#job_form :input[type=checkbox]');
			 $inputs.each(function() {
					if(this.type=='radio')
					{

						cl=$(this).attr('class');

						console.log('Name '+this.name+' = '+cl.indexOf('radio_button'));

						if((this.name && is_checklist==0) || cl.indexOf('radio_button')>=0)
						{
							var checked_val = $("input[name="+this.name+"]:checked").val();
						
							data.append(this.name,checked_val);
						}
						
					}
					else
					{
						data.append(this.name,$(this).val());
					}
					
			});		
			
			if(is_checklist==0)
				is_checklist='<?php echo EIP_CHECKLIST_MAX_ROWS; ?>';

			if($('input[name="is_equipment_stopped"]').length>0)
			{
				/*data.append('is_equipment_stopped',$('input[name="is_equipment_stopped"]:checked'));

				data.append('is_stopped_isoloated',$('input[name="is_stopped_isoloated"]:checked'));

				data.append('is_isoloation_drained_fully',$('input[name="is_isoloation_drained_fully"]:checked'));

				data.append('is_isoloation_permit',$('input[name="is_isoloation_permit"]:checked'));*/
			}	

			//console.log('Checked '+$('input[name="is_equipment_stopped"]:checked').val()+' = ');

			//return false;

			data.append('is_checklist',is_checklist);

					var vls='';
					$(".is_isoloation_drained_fully_options:checked").each(function ()
					{
						vls+=$(this).val()+',';
					});
					
					vls=vls.replace(/,+$/,'');
					
					data.append('is_isoloation_drained_fully_options',vls);
			
					data.append('remarks_issuing_authority_1',$('#remarks_issuing_authority_1').val());
					data.append('remarks_issuing_authority_2',$('#remarks_issuing_authority_2').val());
					
					$("#job_form button[type='submit']").html("<i class=\"fa fa-dot-circle-o\"></i> Processing").attr('disabled',true);$(".btn-danger").attr('disabled',true);			
					

					//alert('Success'); return false;	
					$.ajax({
							url: '<?php echo base_url(); ?>jobs_isolations/ajax_energy_form_action',
							type: 'POST',
							"beforeSend": function(){ },
							data: data,
							cache: false,
							dataType: 'json',
							processData: false, // Don't process the files
							contentType: false, // Set content type to false as jQuery will tell the server its a query string request
							success: function(data, textStatus, jqXHR)
							{
									 if(data.status==false)
				                     {
				                        window.location.href=base_url+'jobs_isolations/form/id/'+$('#id').val();
				                     }
				                     else
				                     {
											var data_id=data.id;

											var eip_no=data.eip_no;
											
											var print_out=data.print_out;
											
											if(print_out=='error')
											{
												window.location.href=base_url+'/jobs_isolations';
												
												return false;	
											}
											<?php
											if($is_popup==1)
											{
											?>			
												parent.$('#is_popup_submit').val('1');									

												opt='<option value="'+data_id+'"  selected="selected">'+$('#section').val()+'(#'+eip_no+')</option>';
												
												parent.$('#isoloation_permit_no').append(opt).trigger("change");

												parent.$('.show_button').trigger('click');

												self.parent.tb_remove();
											
											<?php
											}
											else
											{
											?>
												if(print_out!='')
												{
													$('.print_out:first').trigger('click');
													
													 setTimeout(function () { 
		     												window.location.href=base_url+'/jobs_isolations';
		   											 }, 10 * 1000);
													
												}
												else										
												{
													window.location.href=base_url+'/jobs_isolations';
												}
											<?php
											}
											?>
									 }		
								
							},
							error: function(data, textStatus,errorThrown)
							{
									$('#error').show();
									
									$('#error_msg').html(data.failure);
							}
						});	
						
						return false;		
			
        }
    });
		
	$(document).ready(function() {

	

     $('body').on('change','.is_equipment_radio',function() 
     {
     		var id=$(this).attr('data-id');

     		var val=$(this).val();

     		var data_type=$(this).attr('data-type');

     		console.log('Change working '+$(this).val() + ' = '+data_type);

     		if(val=='No')
     		{
     			//$(".isolate_type"+id+" option[value='']").attr('selected', true).change();

     			$(".isolate_type"+id).val('');

     			$('.equipment_tag_no'+id).val('');

     			$(".isolate_type"+id).prop('disabled',true);

     			$(".equipment_descriptions"+id).prop('disabled',true);

     			$(".equipment_tag_no"+id).prop('disabled',true);

     			if(data_type=='text')
     			{
     				$(".equipment_descriptions"+id).val('');

     				$('.equipment_remarks'+id).prop('disabled',true);
     			}
     			else
     				$('.equipment_remarks'+id).prop('disabled',false);
     		}
     		else
     		{	
     			var eq_no='';

     			if(data_type=='radio')
     			{
	     			var eq_no=$('option:selected', $(".equipment_descriptions"+id)).attr('data-eq-no');

	     			$('.equipment_remarks'+id).val('');

     				$('.equipment_remarks'+id).prop('disabled',true);
				}
				else
				{
					$(".equipment_tag_no"+id).prop('disabled',false);

					$('.equipment_remarks'+id).prop('disabled',false);

				}	
				//console.log('Tag '+'.equipment_tag_no'+id); console.log('Length '+$('.equipment_tag_no'+id).length);

     			$(".isolate_type"+id).prop('disabled',false);

     			$('.equipment_tag_no'+id).val(eq_no);

     			$(".equipment_descriptions"+id).prop('disabled',false);
     		}

     });
		
	$('#gritter_trigger').val(''); // swathi - skip gritter success popup
		
	$('#performing_authority_id3').change(function()	
	{
		var val=$(this).val();
		
		if(val!='')
		{
			$('.department_completion_users').removeAttr('disabled');
		}
		else
			$('.department_completion_users').attr('disabled',true).val('');
		
	});


	
	$('body').on('change','.authority_sign',function() 	
	{
		var data_attr=$(this).attr('data-attr');
		
		var data_selection=$(this).attr('data-selection');
		
		var date_field=$(this).attr('data-date-field');
		
		var val=$(this).val();
		
		 var associate_value='';
		
			if(data_selection=='pa')
				var associate_value=$('.temporary_ia'+data_attr).val();	
			else
				var associate_value=$('.temporary_pa'+data_attr).val();	
		
		if(data_selection=='pa' && val!='')
		$('.'+date_field).val(ShowLocalDate());
		else if(data_selection=='pa' && val=='')
		$('.'+date_field).val('');
	});
	
	$('body').on('change','.temporary_re_pa',function() 	
	{
		var data_attr=$(this).attr('data-attr');
		
		var val=$(this).val();
		
		$('.temporary_re_ia'+data_attr).attr('disabled',true).val('');
		$('.temporary_re_iso'+data_attr).attr('disabled',true).val('');

		$('.isolation_re_equipment_row1'+data_attr).attr('disabled',true).val('');
		$('.isolation_re_equipment_row2'+data_attr).attr('disabled',true).val('');
		
		var data_iso=$('.temporary_iso'+data_attr).val();

		if(val!='')
		{
			$('.temporary_re_ia'+data_attr).removeAttr('disabled');

			$('.temporary_re_iso'+data_attr).removeAttr('disabled');

			$('.isolation_re_equipment_row1'+data_attr).removeAttr('disabled');
			$('.isolation_re_equipment_row2'+data_attr).removeAttr('disabled');
		}
			
		
	});
	
	


		
			$('.show_button').click(function() {
				$('#show_button').val($(this).val());
			});	
	

		


	/*$('.electrical_dept_completion_user').change(function() { 

		var val=$(this).val();

		if(val=='')
		{
			$('#issuing_authority_3_name').attr('disabled',true);

			$('#issuing_authority_3_name').val('');
		}
		else
		{
			$('#issuing_authority_3_name').removeAttr('disabled');
		}	

	});*/
		
	$('.generate_date').change(function() 
	{
				
				var va=$(this).val();
				
				var date_field=$(this).attr('data-date-field');
				
				var issue_id=$(this).attr('data-issue-field');
				
				var select_ia_id=$(this).attr('data-select-ia');
				
				$('#'+date_field).val('');

				//console.log('DD '+issue_id);
				
				if(va!='')				
				{
					$('#'+date_field).val(ShowLocalDate());
					
					if(typeof select_ia_id!=='undefined')
					$('#'+issue_id).val($('#'+select_ia_id).val());
					else
					$('#'+issue_id).removeAttr('disabled');

					/*if(issue_id=='issuing_authority_id3')
					$('#issuing_authority_3_name').removeAttr('disabled');*/
				}
				else
				{
					$('#'+issue_id).attr('disabled',true);
					
					$("#"+issue_id).val('');

					/*if(issue_id=='issuing_authority_id3')
					$('#issuing_authority_3_name').attr('disabled',true);*/
				}
	});	
		
		function ShowLocalDate()
		{
			var dNow = new Date();
			
			//var localdate= dNow.getDate() + '-' + (dNow.getMonth()+1) + '-' + dNow.getFullYear() + ' ' + dNow.getHours() + ':' + dNow.getMinutes();
				var localdate= ( (dNow.getDate()<10?'0':'') + dNow.getDate() ) + '-' + ( ((dNow.getMonth()+1)<10?'0':'') + (dNow.getMonth()+1) ) + '-' + dNow.getFullYear() + ' ' + ( (dNow.getHours()<10?'0':'') + dNow.getHours() ) + ':' +
			 ( (dNow.getMinutes()<10?'0':'') + dNow.getMinutes() );

			return localdate;
			
		}
		
		var last_time = new Date().getTime();
		
		var current_time=ShowLocalDate();
		
		current_time_split=current_time.split(' ');
		
		current_time=current_time_split[0];
		
		current_time=current_time.replace(/\-/g, '');
		
		var system_time='<?php echo date('dmY'); ?>';
		
		if(current_time!=system_time)
		{
			alert('System date is changed. Please change correct date and refresh this page');
			
				$('input,select').attr('disabled',true);
				
				$('.show_button').hide();
				
			return false;	
		}
		
		
		
	});	
	
	
</script>		

            
